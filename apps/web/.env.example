# CampoTech Web App - Environment Variables
# Copy this file to .env.local and fill in your values

# ═══════════════════════════════════════════════════════════════════════════════
# DATABASE
# ═══════════════════════════════════════════════════════════════════════════════

# Supabase PostgreSQL connection string
# ┌─────────────────────────────────────────────────────────────────────────────┐
# │ IMPORTANT: Use the POOLER URL in production for better connection          │
# │ management with serverless functions (Vercel, etc.)                         │
# │                                                                             │
# │ Direct URL (port 5432) - Use for migrations only:                          │
# │   postgresql://postgres:[PASSWORD]@db.[PROJECT-REF].supabase.co:5432/postgres│
# │                                                                             │
# │ Pooler URL (port 6543) - Use for application/production:                   │
# │   postgresql://postgres.[PROJECT-REF]:[PASSWORD]@aws-0-[REGION].pooler.supabase.com:6543/postgres │
# │                                                                             │
# │ Get your pooler URL from: Supabase Dashboard → Settings → Database        │
# │ → Connection String → Mode: "Transaction" (recommended for serverless)     │
# └─────────────────────────────────────────────────────────────────────────────┘
DATABASE_URL="postgresql://postgres.[PROJECT-REF]:[PASSWORD]@aws-0-[REGION].pooler.supabase.com:6543/postgres"

# Direct URL for migrations (bypasses PgBouncer, required for Prisma migrations)
# Keep this separate from DATABASE_URL when using pooler
# DIRECT_DATABASE_URL="postgresql://postgres:[PASSWORD]@db.[PROJECT-REF].supabase.co:5432/postgres"

# Read Replica URL (Phase 5A.3) - Optional
# Enable in Supabase Dashboard → Database → Read Replicas (Pro plan required)
# Used for analytics and heavy read queries to offload primary database
# DATABASE_REPLICA_URL="postgresql://postgres:[PASSWORD]@db.[PROJECT-REF]-replica.supabase.co:5432/postgres"

# ───────────────────────────────────────────────────────────────────────────────
# Connection Pool Settings (Phase 5A.4)
# Configure Prisma connection pool behavior for serverless environments
# Implementation: lib/db/connections.ts
# ───────────────────────────────────────────────────────────────────────────────

# Max connections per Prisma Client instance (default: 5)
# Keep low (2-5) for serverless to avoid exhausting PgBouncer pool
# Supabase pool limits by plan: Free=20, Pro=60, Team=100
# DB_CONNECTION_LIMIT="5"

# Timeout waiting for a connection from pool in seconds (default: 10)
# DB_POOL_TIMEOUT="10"

# Timeout for establishing a new connection in seconds (default: 10)
# DB_CONNECT_TIMEOUT="10"

# ═══════════════════════════════════════════════════════════════════════════════
# AUTHENTICATION
# ═══════════════════════════════════════════════════════════════════════════════

# JWT Secret (generate with: openssl rand -base64 32)
JWT_SECRET="your-super-secret-jwt-key-change-this-in-production"

# ═══════════════════════════════════════════════════════════════════════════════
# TWILIO SMS (for OTP delivery)
# ═══════════════════════════════════════════════════════════════════════════════

# Get these from https://console.twilio.com/
TWILIO_ACCOUNT_SID="ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
TWILIO_AUTH_TOKEN="your-twilio-auth-token"
TWILIO_PHONE_NUMBER="+1234567890"  # Your Twilio phone number

# Optional: Allow dev OTP bypass (code "123456") in production
# Only set to "true" for staging environments, NEVER in real production
# ALLOW_DEV_OTP="false"

# ═══════════════════════════════════════════════════════════════════════════════
# MERCADOPAGO (Payment Processing)
# ═══════════════════════════════════════════════════════════════════════════════

# Get these from https://www.mercadopago.com.ar/developers
MERCADOPAGO_ACCESS_TOKEN="APP_USR-xxxxxxxxxxxxxxxx-xxxxxx-xxxx"
MERCADOPAGO_PUBLIC_KEY="APP_USR-xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"

# ───────────────────────────────────────────────────────────────────────────────
# MercadoPago Subscription Payments (Phase 2.2)
# These are used specifically for CampoTech subscription billing
# ───────────────────────────────────────────────────────────────────────────────

# Platform access token for subscription management
# Use the same credentials as above, or create a separate app for subscriptions
MP_ACCESS_TOKEN="APP_USR-xxxxxxxxxxxxxxxx-xxxxxx-xxxx"
MP_PUBLIC_KEY="APP_USR-xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"

# Subscription Plan IDs (Optional - for recurring billing integration)
# Create these in MercadoPago Dashboard > Subscriptions > Plans
# If not set, one-time payments will be used instead of recurring
#
# INICIAL tier plans ($25,000 ARS monthly / $250,000 ARS yearly)
# MP_PLAN_INICIAL_MONTHLY=""
# MP_PLAN_INICIAL_YEARLY=""
#
# PROFESIONAL tier plans ($55,000 ARS monthly / $550,000 ARS yearly)
# MP_PLAN_PROFESIONAL_MONTHLY=""
# MP_PLAN_PROFESIONAL_YEARLY=""
#
# EMPRESA tier plans ($120,000 ARS monthly / $1,200,000 ARS yearly)
# MP_PLAN_EMPRESA_MONTHLY=""
# MP_PLAN_EMPRESA_YEARLY=""

# ═══════════════════════════════════════════════════════════════════════════════
# AFIP (Electronic Invoicing)
# ═══════════════════════════════════════════════════════════════════════════════

# AFIP Web Services environment: "production" or "homologation"
AFIP_ENVIRONMENT="homologation"

# AFIP Certificate (base64 encoded .pfx file)
# AFIP_CERTIFICATE_BASE64=""
# AFIP_CERTIFICATE_PASSWORD=""

# ═══════════════════════════════════════════════════════════════════════════════
# WHATSAPP BUSINESS API (Meta Cloud API)
# ═══════════════════════════════════════════════════════════════════════════════
# Documentation: https://developers.facebook.com/docs/whatsapp/cloud-api
# Setup Guide: https://developers.facebook.com/docs/whatsapp/cloud-api/get-started

# Meta App Secret - Required for webhook signature validation
# Get from: Facebook Developer Console > App Settings > Basic > App Secret
WHATSAPP_APP_SECRET="your-meta-app-secret"

# Global webhook verification token (used if org-specific not set)
# Create your own random string for webhook verification
WHATSAPP_WEBHOOK_VERIFY_TOKEN="your-webhook-verify-token"
WHATSAPP_VERIFY_TOKEN="your-webhook-verify-token"  # Alias for compatibility

# Default WhatsApp Business Account credentials (optional - can be per-org)
# Get from: Facebook Developer Console > WhatsApp > API Setup
# WHATSAPP_PHONE_NUMBER_ID="your-phone-number-id"
# WHATSAPP_ACCESS_TOKEN="your-permanent-access-token"

# WhatsApp Business Account ID (optional)
# WHATSAPP_BUSINESS_ACCOUNT_ID="your-waba-id"

# API Version (default: v18.0)
WHATSAPP_API_VERSION="v18.0"

# ═══════════════════════════════════════════════════════════════════════════════
# PUSHER (Real-Time Updates)
# ═══════════════════════════════════════════════════════════════════════════════
# Documentation: https://pusher.com/docs/channels
# Get credentials from: https://dashboard.pusher.com/

# Pusher App ID
PUSHER_APP_ID="your-pusher-app-id"

# Pusher API Key (server-side)
PUSHER_KEY="your-pusher-key"

# Pusher Secret (server-side only - keep secure)
PUSHER_SECRET="your-pusher-secret"

# Pusher Cluster (e.g., us2, eu, ap1)
PUSHER_CLUSTER="us2"

# Client-side Pusher Key (same as PUSHER_KEY, exposed to browser)
NEXT_PUBLIC_PUSHER_KEY="your-pusher-key"

# Client-side Pusher Cluster
NEXT_PUBLIC_PUSHER_CLUSTER="us2"

# ═══════════════════════════════════════════════════════════════════════════════
# OPENAI (Voice AI Processing)
# ═══════════════════════════════════════════════════════════════════════════════

# Get from https://platform.openai.com/api-keys
# OPENAI_API_KEY=""

# ═══════════════════════════════════════════════════════════════════════════════
# GOOGLE MAPS (Address Autocomplete)
# ═══════════════════════════════════════════════════════════════════════════════

# Get from https://console.cloud.google.com/apis/credentials
# Enable these APIs:
#   - "Places API (New)" (required for address autocomplete)
#   - "Maps JavaScript API" (required for map display)
NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=""

# ═══════════════════════════════════════════════════════════════════════════════
# APPLICATION
# ═══════════════════════════════════════════════════════════════════════════════

# Application URL (for callbacks, webhooks)
NEXT_PUBLIC_APP_URL="http://localhost:3000"

# Node environment
NODE_ENV="development"

# ═══════════════════════════════════════════════════════════════════════════════
# UPSTASH REDIS (Caching Layer - Phase 5.2)
# ═══════════════════════════════════════════════════════════════════════════════
# Documentation: https://upstash.com/docs/redis/overall/getstarted
# Get credentials from: https://console.upstash.com/

# Upstash Redis REST URL
# Format: https://[region]-[id].upstash.io
UPSTASH_REDIS_REST_URL="https://your-redis.upstash.io"

# Upstash Redis REST Token
UPSTASH_REDIS_REST_TOKEN="your-upstash-redis-token"

# Optional: KV prefix for multi-tenant environments
# CACHE_KEY_PREFIX="campotech:"

# ═══════════════════════════════════════════════════════════════════════════════
# SUPABASE STORAGE (Data Archival - Phase 5A.2)
# ═══════════════════════════════════════════════════════════════════════════════
# Documentation: https://supabase.com/docs/guides/storage
# Get credentials from: https://supabase.com/dashboard/project/_/settings/api

# Supabase Project URL
# Format: https://[project-ref].supabase.co
SUPABASE_URL="https://your-project.supabase.co"

# Supabase Service Role Key (server-side only - keep secure!)
# Required for storage operations, has full access
SUPABASE_SERVICE_ROLE_KEY="your-service-role-key"

# ═══════════════════════════════════════════════════════════════════════════════
# CRON JOBS (Scheduled Tasks - Phase 5A)
# ═══════════════════════════════════════════════════════════════════════════════

# Secret for authenticating cron job requests
# Generate with: openssl rand -base64 32
CRON_SECRET="your-cron-secret-key"

# ═══════════════════════════════════════════════════════════════════════════════
# QUEUE SYSTEM (Background Jobs - Phase 5B.1)
# ═══════════════════════════════════════════════════════════════════════════════
# Uses Upstash Redis (same as caching layer above)
# Documentation: https://upstash.com/docs/redis/overall/getstarted

# Queue Configuration (optional - defaults shown)
# Polling interval for workers in milliseconds
# QUEUE_POLL_INTERVAL="1000"

# Maximum jobs to fetch per poll
# QUEUE_BATCH_SIZE="10"

# Enable debug logging for queue operations
# QUEUE_DEBUG="false"

# ═══════════════════════════════════════════════════════════════════════════════
# RATE LIMITING (Phase 6.1)
# ═══════════════════════════════════════════════════════════════════════════════
# Uses Upstash Redis (same as caching layer above)
# Documentation: https://upstash.com/docs/redis/sdks/ratelimit-ts/overview

# Rate limits per tier (requests per minute)
# These are defaults - modify based on your needs
# RATE_LIMIT_FREE="30"
# RATE_LIMIT_BASICO="100"
# RATE_LIMIT_PROFESIONAL="500"
# RATE_LIMIT_EMPRESARIAL="2000"

# Stricter limit for auth endpoints (login, register)
# RATE_LIMIT_AUTH="10"

# Enable rate limiting (default: true when Redis is configured)
# RATE_LIMIT_ENABLED="true"

# ═══════════════════════════════════════════════════════════════════════════════
# MONITORING (Phase 8)
# ═══════════════════════════════════════════════════════════════════════════════
# Documentation: https://docs.sentry.io/platforms/javascript/guides/nextjs/
# Setup: Create a Sentry account at https://sentry.io and create a Next.js project

# Sentry DSN for error tracking (server-side)
# Get from: https://sentry.io/settings/projects/YOUR-PROJECT/keys/
SENTRY_DSN=""

# Sentry DSN for client-side (same as SENTRY_DSN, exposed to browser)
NEXT_PUBLIC_SENTRY_DSN=""

# Sentry organization and project slugs (for source map uploads)
SENTRY_ORG="campotech"
SENTRY_PROJECT="web"

# Sentry auth token for source map uploads (set in CI/CD only)
# Generate at: https://sentry.io/settings/auth-tokens/
# SENTRY_AUTH_TOKEN=""

# Sentry environment (automatically set based on NODE_ENV if not specified)
# SENTRY_ENVIRONMENT="production"

# Sample rates for production (0.0-1.0)
# Traces sample rate (performance monitoring)
# SENTRY_TRACES_SAMPLE_RATE="0.1"

# Profiles sample rate (profiling)
# SENTRY_PROFILES_SAMPLE_RATE="0.1"

# Metrics endpoint authentication (for Prometheus scraping)
# Generate with: openssl rand -base64 32
# Set this in production to secure the /api/monitoring/metrics endpoint
# METRICS_AUTH_TOKEN=""

# ═══════════════════════════════════════════════════════════════════════════════
# ALERTING (Phase 8.3)
# ═══════════════════════════════════════════════════════════════════════════════
# Documentation: Configure alert channels for critical notifications

# Slack Webhook URL for error notifications
# Get from: https://api.slack.com/messaging/webhooks
# SLACK_WEBHOOK_URL=""

# Discord Webhook URL for error notifications (alternative to Slack)
# DISCORD_WEBHOOK_URL=""

# PagerDuty integration key for critical alerts
# Get from: PagerDuty > Services > Integrations > Add Integration > Events API v2
# PAGERDUTY_INTEGRATION_KEY=""

# Alert thresholds
# Error rate percentage that triggers an alert
# ALERT_ERROR_RATE_THRESHOLD="5"

# Response time threshold in milliseconds
# ALERT_RESPONSE_TIME_THRESHOLD="5000"

# DLQ depth threshold that triggers an alert
# ALERT_DLQ_DEPTH_THRESHOLD="100"
