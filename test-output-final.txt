
> campotech@1.0.0 test D:\projects\CampoTech
> jest

node.exe : ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. 
Please do
At C:\Users\lapto\AppData\Roaming\npm\pnpm.ps1:24 char:5
+     & "node$exe"  "$basedir/node_modules/pnpm/bin/pnpm.cjs" $args
+     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (ts-jest[ts-jest...ated. Please do:String) [], RemoteExcep 
   tion
    + FullyQualifiedErrorId : NativeCommandError
 
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) 
    The "ts-jest" config option "isolatedModules" is deprecated and will be removed in v30.0.0. Please 
use "isolatedModules: true", see https://www.typescriptlang.org/tsconfig/#isolatedModules
  
ts-jest[config] (WARN) 
    The "ts-jest" config option "isolatedModules" is deprecated and will be removed in v30.0.0. Please 
use "isolatedModules: true", see https://www.typescriptlang.org/tsconfig/#isolatedModules
  
ts-jest[config] (WARN) 
    The "ts-jest" config option "isolatedModules" is deprecated and will be removed in v30.0.0. Please 
use "isolatedModules: true", see https://www.typescriptlang.org/tsconfig/#isolatedModules
  
ts-jest[config] (WARN) 
    The "ts-jest" config option "isolatedModules" is deprecated and will be removed in v30.0.0. Please 
use "isolatedModules: true", see https://www.typescriptlang.org/tsconfig/#isolatedModules
  
ts-jest[config] (WARN) 
    The "ts-jest" config option "isolatedModules" is deprecated and will be removed in v30.0.0. Please 
use "isolatedModules: true", see https://www.typescriptlang.org/tsconfig/#isolatedModules
  
ts-jest[config] (WARN) 
    The "ts-jest" config option "isolatedModules" is deprecated and will be removed in v30.0.0. Please 
use "isolatedModules: true", see https://www.typescriptlang.org/tsconfig/#isolatedModules
  
ts-jest[config] (WARN) 
    The "ts-jest" config option "isolatedModules" is deprecated and will be removed in v30.0.0. Please 
use "isolatedModules: true", see https://www.typescriptlang.org/tsconfig/#isolatedModules
  
ts-jest[config] (WARN) 
    The "ts-jest" config option "isolatedModules" is deprecated and will be removed in v30.0.0. Please 
use "isolatedModules: true", see https://www.typescriptlang.org/tsconfig/#isolatedModules
  
ts-jest[config] (WARN) 
    The "ts-jest" config option "isolatedModules" is deprecated and will be removed in v30.0.0. Please 
use "isolatedModules: true", see https://www.typescriptlang.org/tsconfig/#isolatedModules
  
ts-jest[config] (WARN) 
    The "ts-jest" config option "isolatedModules" is deprecated and will be removed in v30.0.0. Please 
use "isolatedModules: true", see https://www.typescriptlang.org/tsconfig/#isolatedModules
  
ts-jest[config] (WARN) 
    The "ts-jest" config option "isolatedModules" is deprecated and will be removed in v30.0.0. Please 
use "isolatedModules: true", see https://www.typescriptlang.org/tsconfig/#isolatedModules
  
FAIL src/api/public/sdk/openapi.test.ts
  ΓùÅ Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (node_modules/.pnpm/@jest+core@29.7.0_ts-node@1_4b536c4b55983dea7b43151a581ff67c/node
_modules/@jest/core/build/TestScheduler.js:133:18)
      at node_modules/.pnpm/@jest+core@29.7.0_ts-node@1_4b536c4b55983dea7b43151a581ff67c/node_modules/@
jest/core/build/TestScheduler.js:254:19
      at node_modules/.pnpm/emittery@0.13.1/node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (node_modules/.pnpm/emittery@0.13.1/node_modules/emittery/index.js:361:23)

FAIL apps/web/__tests__/whatsapp/client.test.ts
  ΓùÅ Test suite failed to run

    Configuration error:

    Could not locate module @/src/integrations/whatsapp/client mapped as:
    D:\projects\CampoTech\apps\web\$1.

    Please check your configuration for these entries:
    {
      "moduleNameMapper": {
        "/^@\/(.*)$/": "D:\projects\CampoTech\apps\web\$1"
      },
      "resolver": undefined
    }

    [0m [90m  8 |[39m [90m// Using Jest globals[39m
     [90m  9 |[39m [36mimport[39m axios [36mfrom[39m [32m'axios'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 10 |[39m [36mimport[39m { [33mWhatsAppClient[39m } [36mfrom[39m 
[32m'@/src/integrations/whatsapp/client'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 11 |[39m
     [90m 12 |[39m [90m// Mock axios[39m
     [90m 13 |[39m jest[33m.[39mmock([32m'axios'[39m[33m,[39m () [33m=>[39m ({[0m

      at createNoMappedModuleFoundError 
(node_modules/.pnpm/jest-resolve@29.7.0/node_modules/jest-resolve/build/resolver.js:759:17)
      at Object.<anonymous> (apps/web/__tests__/whatsapp/client.test.ts:10:1)

FAIL apps/web/e2e/tests/whatsapp.spec.ts
  ΓùÅ Test suite failed to run

    Cannot find module '@playwright/test' from 'apps/web/e2e/tests/whatsapp.spec.ts'

    [0m [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
    [31m[1m>[22m[39m[90m 12 |[39m [36mimport[39m { test[33m,[39m expect[33m,[39m 
[33mPage[39m } [36mfrom[39m [32m'@playwright/test'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 13 |[39m
     [90m 14 |[39m [90m// Test fixtures[39m
     [90m 15 |[39m [36mconst[39m [33mTEST_USER[39m [33m=[39m {[0m

      at Resolver._throwModNotFoundError 
(node_modules/.pnpm/jest-resolve@29.7.0/node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (apps/web/e2e/tests/whatsapp.spec.ts:12:1)

FAIL apps/web/tests/integration/whatsapp/bsp-flow.test.ts
  ΓùÅ Test suite failed to run

    Vitest cannot be imported in a CommonJS module using require(). Please use "import" instead.

    If you are using "import" in your source code, then it's possible it was bundled into require() 
automatically by your bundler. In that case, do not bundle CommonJS output since it will never work 
with Vitest, or use dynamic import() which is available in all CommonJS modules.

    [0m [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
    [31m[1m>[22m[39m[90m 12 |[39m [36mimport[39m { describe[33m,[39m it[33m,[39m 
expect[33m,[39m vi[33m,[39m beforeEach[33m,[39m afterEach[33m,[39m beforeAll } [36mfrom[39m 
[32m'vitest'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 13 |[39m
     [90m 14 |[39m [90m// Mock environment[39m
     [90m 15 |[39m vi[33m.[39mstubEnv([32m'DIALOG360_PARTNER_API_KEY'[39m[33m,[39m 
[32m'test_partner_key'[39m)[33m;[39m[0m

      at Object.<anonymous> (node_modules/.pnpm/vitest@4.0.16_@opentelemetr_470a0d18cc2b6d8033e671acb56
0b11f/node_modules/vitest/index.cjs:1:109)
      at Object.<anonymous> (apps/web/tests/integration/whatsapp/bsp-flow.test.ts:12:1)

FAIL apps/web/tests/unit/payment-processor.test.ts
  ΓùÅ Test suite failed to run

    Vitest cannot be imported in a CommonJS module using require(). Please use "import" instead.

    If you are using "import" in your source code, then it's possible it was bundled into require() 
automatically by your bundler. In that case, do not bundle CommonJS output since it will never work 
with Vitest, or use dynamic import() which is available in all CommonJS modules.

    [0m [90m 11 |[39m [90m */[39m
     [90m 12 |[39m
    [31m[1m>[22m[39m[90m 13 |[39m [36mimport[39m { vi } [36mfrom[39m 
[32m'vitest'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 14 |[39m
     [90m 15 |[39m [90m// ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓò
ÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ
ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ[39m
     [90m 16 |[39m [90m// TYPES[39m[0m

      at Object.<anonymous> (node_modules/.pnpm/vitest@4.0.16_@opentelemetr_470a0d18cc2b6d8033e671acb56
0b11f/node_modules/vitest/index.cjs:1:109)
      at Object.<anonymous> (apps/web/tests/utils/subscription-test-helpers.ts:13:1)
      at Object.<anonymous> (apps/web/tests/unit/payment-processor.test.ts:13:1)

PASS apps/web/tests/unit/permissions.test.ts
FAIL apps/web/tests/unit/trial-manager.test.ts
  ΓùÅ Test suite failed to run

    Vitest cannot be imported in a CommonJS module using require(). Please use "import" instead.

    If you are using "import" in your source code, then it's possible it was bundled into require() 
automatically by your bundler. In that case, do not bundle CommonJS output since it will never work 
with Vitest, or use dynamic import() which is available in all CommonJS modules.

    [0m [90m 11 |[39m [90m */[39m
     [90m 12 |[39m
    [31m[1m>[22m[39m[90m 13 |[39m [36mimport[39m { vi } [36mfrom[39m 
[32m'vitest'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 14 |[39m
     [90m 15 |[39m [90m// ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓò
ÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ
ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ[39m
     [90m 16 |[39m [90m// TYPES[39m[0m

      at Object.<anonymous> (node_modules/.pnpm/vitest@4.0.16_@opentelemetr_470a0d18cc2b6d8033e671acb56
0b11f/node_modules/vitest/index.cjs:1:109)
      at Object.<anonymous> (apps/web/tests/utils/subscription-test-helpers.ts:13:1)
      at Object.<anonymous> (apps/web/tests/unit/trial-manager.test.ts:13:1)

FAIL apps/web/tests/unit/verification-manager.test.ts
  ΓùÅ Test suite failed to run

    Vitest cannot be imported in a CommonJS module using require(). Please use "import" instead.

    If you are using "import" in your source code, then it's possible it was bundled into require() 
automatically by your bundler. In that case, do not bundle CommonJS output since it will never work 
with Vitest, or use dynamic import() which is available in all CommonJS modules.

    [0m [90m 11 |[39m [90m */[39m
     [90m 12 |[39m
    [31m[1m>[22m[39m[90m 13 |[39m [36mimport[39m { vi } [36mfrom[39m 
[32m'vitest'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 14 |[39m
     [90m 15 |[39m [90m// ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓò
ÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ
ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ[39m
     [90m 16 |[39m [90m// TYPES[39m[0m

      at Object.<anonymous> (node_modules/.pnpm/vitest@4.0.16_@opentelemetr_470a0d18cc2b6d8033e671acb56
0b11f/node_modules/vitest/index.cjs:1:109)
      at Object.<anonymous> (apps/web/tests/utils/subscription-test-helpers.ts:13:1)
      at Object.<anonymous> (apps/web/tests/unit/verification-manager.test.ts:13:1)

FAIL apps/web/tests/unit/block-manager.test.ts
  ΓùÅ Test suite failed to run

    Vitest cannot be imported in a CommonJS module using require(). Please use "import" instead.

    If you are using "import" in your source code, then it's possible it was bundled into require() 
automatically by your bundler. In that case, do not bundle CommonJS output since it will never work 
with Vitest, or use dynamic import() which is available in all CommonJS modules.

    [0m [90m 11 |[39m [90m */[39m
     [90m 12 |[39m
    [31m[1m>[22m[39m[90m 13 |[39m [36mimport[39m { vi } [36mfrom[39m 
[32m'vitest'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 14 |[39m
     [90m 15 |[39m [90m// ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓò
ÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ
ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ[39m
     [90m 16 |[39m [90m// TYPES[39m[0m

      at Object.<anonymous> (node_modules/.pnpm/vitest@4.0.16_@opentelemetr_470a0d18cc2b6d8033e671acb56
0b11f/node_modules/vitest/index.cjs:1:109)
      at Object.<anonymous> (apps/web/tests/utils/subscription-test-helpers.ts:13:1)
      at Object.<anonymous> (apps/web/tests/unit/block-manager.test.ts:13:1)

FAIL apps/web/tests/integration/subscription-flow.test.ts
  ΓùÅ Test suite failed to run

    Vitest cannot be imported in a CommonJS module using require(). Please use "import" instead.

    If you are using "import" in your source code, then it's possible it was bundled into require() 
automatically by your bundler. In that case, do not bundle CommonJS output since it will never work 
with Vitest, or use dynamic import() which is available in all CommonJS modules.

    [0m [90m 11 |[39m [90m */[39m
     [90m 12 |[39m
    [31m[1m>[22m[39m[90m 13 |[39m [36mimport[39m { vi } [36mfrom[39m 
[32m'vitest'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 14 |[39m
     [90m 15 |[39m [90m// ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓò
ÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ
ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ[39m
     [90m 16 |[39m [90m// TYPES[39m[0m

      at Object.<anonymous> (node_modules/.pnpm/vitest@4.0.16_@opentelemetr_470a0d18cc2b6d8033e671acb56
0b11f/node_modules/vitest/index.cjs:1:109)
      at Object.<anonymous> (apps/web/tests/utils/subscription-test-helpers.ts:13:1)
      at Object.<anonymous> (apps/web/tests/integration/subscription-flow.test.ts:13:1)

FAIL apps/web/e2e/tests/admin.spec.ts
  ΓùÅ Test suite failed to run

    Cannot find module '@playwright/test' from 'apps/web/e2e/tests/admin.spec.ts'

    [0m [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
    [31m[1m>[22m[39m[90m 12 |[39m [36mimport[39m { test[33m,[39m expect[33m,[39m 
[33mPage[39m } [36mfrom[39m [32m'@playwright/test'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 13 |[39m
     [90m 14 |[39m [90m// Admin test credentials (would be configured in test environment)[39m
     [90m 15 |[39m [36mconst[39m [33mADMIN_USER[39m [33m=[39m {[0m

      at Resolver._throwModNotFoundError 
(node_modules/.pnpm/jest-resolve@29.7.0/node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (apps/web/e2e/tests/admin.spec.ts:12:1)

PASS apps/web/tests/unit/feature-flags.test.ts (5.699 s)
FAIL apps/web/tests/unit/whatsapp/provisioning.test.ts
  ΓùÅ Test suite failed to run

    ReferenceError: vi is not defined

    [0m [90m 41 |[39m [90m// Mock the provider factory to return the shared instance[39m
     [90m 42 |[39m jest[33m.[39mmock([32m'@/lib/integrations/whatsapp/providers'[39m[33m,[39m 
() [33m=>[39m ({
    [31m[1m>[22m[39m[90m 43 |[39m   getBSPProvider[33m:[39m vi[33m.[39mfn(() [33m=>[39m 
mockProvider)[33m,[39m
     [90m    |[39m                   [31m[1m^[22m[39m
     [90m 44 |[39m }))[33m;[39m
     [90m 45 |[39m
     [90m 46 |[39m [90m// Import mocked modules[39m[0m

      at apps/web/tests/unit/whatsapp/provisioning.test.ts:43:19
      at Object.<anonymous> (apps/web/tests/unit/whatsapp/provisioning.test.ts:48:1)

FAIL apps/web/tests/unit/access-control.test.ts
  ΓùÅ Test suite failed to run

    Vitest cannot be imported in a CommonJS module using require(). Please use "import" instead.

    If you are using "import" in your source code, then it's possible it was bundled into require() 
automatically by your bundler. In that case, do not bundle CommonJS output since it will never work 
with Vitest, or use dynamic import() which is available in all CommonJS modules.

    [0m [90m 11 |[39m [90m */[39m
     [90m 12 |[39m
    [31m[1m>[22m[39m[90m 13 |[39m [36mimport[39m { vi } [36mfrom[39m 
[32m'vitest'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 14 |[39m
     [90m 15 |[39m [90m// ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓò
ÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ
ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ[39m
     [90m 16 |[39m [90m// TYPES[39m[0m

      at Object.<anonymous> (node_modules/.pnpm/vitest@4.0.16_@opentelemetr_470a0d18cc2b6d8033e671acb56
0b11f/node_modules/vitest/index.cjs:1:109)
      at Object.<anonymous> (apps/web/tests/utils/subscription-test-helpers.ts:13:1)
      at Object.<anonymous> (apps/web/tests/unit/access-control.test.ts:12:1)

FAIL apps/web/tests/unit/afip-client.test.ts
  ΓùÅ Test suite failed to run

    Vitest cannot be imported in a CommonJS module using require(). Please use "import" instead.

    If you are using "import" in your source code, then it's possible it was bundled into require() 
automatically by your bundler. In that case, do not bundle CommonJS output since it will never work 
with Vitest, or use dynamic import() which is available in all CommonJS modules.

    [0m [90m 11 |[39m [90m */[39m
     [90m 12 |[39m
    [31m[1m>[22m[39m[90m 13 |[39m [36mimport[39m { vi } [36mfrom[39m 
[32m'vitest'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 14 |[39m
     [90m 15 |[39m [90m// ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓò
ÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ
ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ[39m
     [90m 16 |[39m [90m// TYPES[39m[0m

      at Object.<anonymous> (node_modules/.pnpm/vitest@4.0.16_@opentelemetr_470a0d18cc2b6d8033e671acb56
0b11f/node_modules/vitest/index.cjs:1:109)
      at Object.<anonymous> (apps/web/tests/utils/subscription-test-helpers.ts:13:1)
      at Object.<anonymous> (apps/web/tests/unit/afip-client.test.ts:12:1)

FAIL apps/web/__tests__/whatsapp/webhook.test.ts
  ΓùÅ Test suite failed to run

    Configuration error:

    Could not locate module @/src/integrations/whatsapp/webhook/webhook.handler mapped as:
    D:\projects\CampoTech\apps\web\$1.

    Please check your configuration for these entries:
    {
      "moduleNameMapper": {
        "/^@\/(.*)$/": "D:\projects\CampoTech\apps\web\$1"
      },
      "resolver": undefined
    }

    [0m [90m  8 |[39m [90m// Using Jest globals[39m
     [90m  9 |[39m [36mimport[39m crypto [36mfrom[39m [32m'crypto'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 10 |[39m [36mimport[39m {
     [90m    |[39m [31m[1m^[22m[39m
     [90m 11 |[39m   validateWebhookSignature[33m,[39m
     [90m 12 |[39m   verifyWebhook[33m,[39m
     [90m 13 |[39m   parseWebhookPayload[33m,[39m[0m

      at createNoMappedModuleFoundError 
(node_modules/.pnpm/jest-resolve@29.7.0/node_modules/jest-resolve/build/resolver.js:759:17)
      at Object.<anonymous> (apps/web/__tests__/whatsapp/webhook.test.ts:10:1)

FAIL apps/web/e2e/tests/subscription.spec.ts
  ΓùÅ Test suite failed to run

    Cannot find module '@playwright/test' from 'apps/web/e2e/tests/subscription.spec.ts'

    [0m [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
    [31m[1m>[22m[39m[90m 12 |[39m [36mimport[39m { test[33m,[39m expect[33m,[39m 
[33mPage[39m } [36mfrom[39m [32m'@playwright/test'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 13 |[39m
     [90m 14 |[39m [90m// Test fixtures[39m
     [90m 15 |[39m [36mconst[39m [33mTEST_USER[39m [33m=[39m {[0m

      at Resolver._throwModNotFoundError 
(node_modules/.pnpm/jest-resolve@29.7.0/node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (apps/web/e2e/tests/subscription.spec.ts:12:1)

FAIL apps/web/__tests__/whatsapp/notifications.test.ts
  ΓùÅ Test suite failed to run

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard 
JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based 
on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     ΓÇó If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules 
for how to enable it.
     ΓÇó If you are trying to use TypeScript, see 
https://jestjs.io/docs/getting-started#using-typescript
     ΓÇó To have some of your "node_modules" files transformed, you can specify a custom 
"transformIgnorePatterns" in your config.
     ΓÇó If you need a custom transformation specify a "transform" option in your config.
     ΓÇó If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out 
with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    D:\projects\CampoTech\apps\web\__tests__\whatsapp\notifications.test.ts:40
    const { jest } = require('@jest/globals');
            ^

    SyntaxError: Identifier 'jest' has already been declared

      at Runtime.createScriptFromCode 
(node_modules/.pnpm/jest-runtime@29.7.0/node_modules/jest-runtime/build/index.js:1505:14)

PASS apps/web/tests/unit/rating.test.ts
FAIL src/modules/consumer/__tests__/fraud-detection.service.test.ts
  ΓùÅ FraudDetectionService ΓÇ║ Text similarity detection ΓÇ║ should detect similar text with minor 
differences

    expect(received).toBeGreaterThan(expected)

    Expected: > 0.5
    Received:   0.25

    [0m [90m 62 |[39m       )[33m;[39m
     [90m 63 |[39m
    [31m[1m>[22m[39m[90m 64 |[39m       
expect(similarity)[33m.[39mtoBeGreaterThan([35m0.5[39m)[33m;[39m
     [90m    |[39m                          [31m[1m^[22m[39m
     [90m 65 |[39m     })[33m;[39m
     [90m 66 |[39m
     [90m 67 |[39m     it([32m'should detect different texts as dissimilar'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.<anonymous> (src/modules/consumer/__tests__/fraud-detection.service.test.ts:64:26)

  ΓùÅ FraudDetectionService ΓÇ║ Analysis calculation ΓÇ║ should recommend auto_reject for high fraud 
score

    expect(received).toBe(expected) // Object.is equality

    Expected: "auto_reject"
    Received: "manual_review"

    [0m [90m 209 |[39m       [36mconst[39m result [33m=[39m 
calculateAnalysis([32m'review-id'[39m[33m,[39m signals)[33m;[39m
     [90m 210 |[39m
    [31m[1m>[22m[39m[90m 211 |[39m       
expect(result[33m.[39mrecommendation)[33m.[39mtoBe([32m'auto_reject'[39m)[33m;[39m
     [90m     |[39m                                     [31m[1m^[22m[39m
     [90m 212 |[39m       
expect(result[33m.[39moverallScore)[33m.[39mtoBeGreaterThanOrEqual([35m70[39m)[33m;[39m
     [90m 213 |[39m     })[33m;[39m
     [90m 214 |[39m[0m

      at Object.<anonymous> (src/modules/consumer/__tests__/fraud-detection.service.test.ts:211:37)

PASS apps/web/tests/unit/tier-limits.test.ts
FAIL apps/mobile/__tests__/consumer/BusinessCard.test.tsx
  ΓùÅ Test suite failed to run

    Cannot find module '@testing-library/react-native' from 
'apps/mobile/__tests__/consumer/BusinessCard.test.tsx'

    [0m [90m  8 |[39m
     [90m  9 |[39m [36mimport[39m [33mReact[39m [36mfrom[39m [32m'react'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 10 |[39m [36mimport[39m { render[33m,[39m fireEvent } 
[36mfrom[39m [32m'@testing-library/react-native'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 11 |[39m [36mimport[39m [33mBusinessCard[39m [36mfrom[39m 
[32m'../../components/consumer/BusinessCard'[39m[33m;[39m
     [90m 12 |[39m
     [90m 13 |[39m describe([32m'BusinessCard'[39m[33m,[39m () [33m=>[39m {[0m

      at Resolver._throwModNotFoundError 
(node_modules/.pnpm/jest-resolve@29.7.0/node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (apps/mobile/__tests__/consumer/BusinessCard.test.tsx:10:1)

PASS apps/web/tests/unit/whatsapp/wame-links.test.ts
PASS apps/web/tests/unit/cuit.test.ts
FAIL apps/web/tests/unit/whatsapp/dialog360-provider.test.ts (6.902 s)
  ΓùÅ Console

    console.error
      [Dialog360] Failed to get available numbers: { error: 'Internal Server Error' }

    [0m [90m 94 |[39m       [36mif[39m ([33m![39mresponse[33m.[39mok) {
     [90m 95 |[39m         [36mconst[39m error [33m=[39m [36mawait[39m 
response[33m.[39mjson() [36mas[39m [33mDialog360Error[39m[33m;[39m
    [31m[1m>[22m[39m[90m 96 |[39m         console[33m.[39merror([32m'[Dialog360] Failed to 
get available numbers:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 97 |[39m         [36mreturn[39m [][33m;[39m
     [90m 98 |[39m       }
     [90m 99 |[39m[0m

      at Dialog360Provider.<anonymous> 
(apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:96:17)
      at fulfilled (apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:54:58)

    console.error
      [Dialog360] Error provisioning number: TypeError: Cannot read properties of undefined (reading 
'findUnique')
          at Dialog360Provider.<anonymous> 
(D:\projects\CampoTech\apps\web\lib\integrations\whatsapp\providers\dialog360.provider.ts:125:45)
          at Generator.next (<anonymous>)
          at fulfilled 
(D:\projects\CampoTech\apps\web\lib\integrations\whatsapp\providers\dialog360.provider.ts:54:58)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

    [0m [90m 214 |[39m       }[33m;[39m
     [90m 215 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 216 |[39m       console[33m.[39merror([32m'[Dialog360] Error 
provisioning number:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 217 |[39m       [36mreturn[39m {
     [90m 218 |[39m         success[33m:[39m [36mfalse[39m[33m,[39m
     [90m 219 |[39m         status[33m:[39m [32m'NOT_STARTED'[39m[33m,[39m[0m

      at Dialog360Provider.<anonymous> 
(apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:216:15)
      at fulfilled (apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:54:58)

    console.error
      [Dialog360] Error provisioning number: TypeError: Cannot read properties of undefined (reading 
'findUnique')
          at Dialog360Provider.<anonymous> 
(D:\projects\CampoTech\apps\web\lib\integrations\whatsapp\providers\dialog360.provider.ts:125:45)
          at Generator.next (<anonymous>)
          at fulfilled 
(D:\projects\CampoTech\apps\web\lib\integrations\whatsapp\providers\dialog360.provider.ts:54:58)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

    [0m [90m 214 |[39m       }[33m;[39m
     [90m 215 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 216 |[39m       console[33m.[39merror([32m'[Dialog360] Error 
provisioning number:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 217 |[39m       [36mreturn[39m {
     [90m 218 |[39m         success[33m:[39m [36mfalse[39m[33m,[39m
     [90m 219 |[39m         status[33m:[39m [32m'NOT_STARTED'[39m[33m,[39m[0m

      at Dialog360Provider.<anonymous> 
(apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:216:15)
      at fulfilled (apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:54:58)

    console.error
      [Dialog360] Error sending message: TypeError: Cannot read properties of undefined (reading 
'findUnique')
          at Function.<anonymous> 
(D:\projects\CampoTech\apps\web\lib\services\whatsapp-usage.service.ts:145:43)
          at Generator.next (<anonymous>)
          at D:\projects\CampoTech\apps\web\lib\services\whatsapp-usage.service.ts:22:71
          at new Promise (<anonymous>)
          at Object.<anonymous>.__awaiter 
(D:\projects\CampoTech\apps\web\lib\services\whatsapp-usage.service.ts:18:12)
          at Function.getUsageStats 
(D:\projects\CampoTech\apps\web\lib\services\whatsapp-usage.service.ts:103:16)
          at Function.<anonymous> 
(D:\projects\CampoTech\apps\web\lib\services\whatsapp-usage.service.ts:317:30)
          at Generator.next (<anonymous>)
          at D:\projects\CampoTech\apps\web\lib\services\whatsapp-usage.service.ts:22:71
          at new Promise (<anonymous>)
          at Object.<anonymous>.__awaiter 
(D:\projects\CampoTech\apps\web\lib\services\whatsapp-usage.service.ts:18:12)
          at Function.canSendMessage 
(D:\projects\CampoTech\apps\web\lib\services\whatsapp-usage.service.ts:260:16)
          at Dialog360Provider.<anonymous> 
(D:\projects\CampoTech\apps\web\lib\integrations\whatsapp\providers\dialog360.provider.ts:412:53)
          at Generator.next (<anonymous>)
          at fulfilled 
(D:\projects\CampoTech\apps\web\lib\integrations\whatsapp\providers\dialog360.provider.ts:54:58)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

    [0m [90m 470 |[39m       }[33m;[39m
     [90m 471 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 472 |[39m       console[33m.[39merror([32m'[Dialog360] Error sending 
message:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 473 |[39m       [36mreturn[39m {
     [90m 474 |[39m         success[33m:[39m [36mfalse[39m[33m,[39m
     [90m 475 |[39m         error[33m:[39m error [36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Unknown error'[39m[33m,[39m[0m

      at Dialog360Provider.<anonymous> 
(apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:472:15)
          at Generator.throw (<anonymous>)
      at rejected (apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:55:65)

    console.error
      [Dialog360] Error sending message: TypeError: Cannot read properties of undefined (reading 
'findUnique')
          at Function.<anonymous> 
(D:\projects\CampoTech\apps\web\lib\services\whatsapp-usage.service.ts:145:43)
          at Generator.next (<anonymous>)
          at D:\projects\CampoTech\apps\web\lib\services\whatsapp-usage.service.ts:22:71
          at new Promise (<anonymous>)
          at Object.<anonymous>.__awaiter 
(D:\projects\CampoTech\apps\web\lib\services\whatsapp-usage.service.ts:18:12)
          at Function.getUsageStats 
(D:\projects\CampoTech\apps\web\lib\services\whatsapp-usage.service.ts:103:16)
          at Function.<anonymous> 
(D:\projects\CampoTech\apps\web\lib\services\whatsapp-usage.service.ts:317:30)
          at Generator.next (<anonymous>)
          at D:\projects\CampoTech\apps\web\lib\services\whatsapp-usage.service.ts:22:71
          at new Promise (<anonymous>)
          at Object.<anonymous>.__awaiter 
(D:\projects\CampoTech\apps\web\lib\services\whatsapp-usage.service.ts:18:12)
          at Function.canSendMessage 
(D:\projects\CampoTech\apps\web\lib\services\whatsapp-usage.service.ts:260:16)
          at Dialog360Provider.<anonymous> 
(D:\projects\CampoTech\apps\web\lib\integrations\whatsapp\providers\dialog360.provider.ts:412:53)
          at Generator.next (<anonymous>)
          at fulfilled 
(D:\projects\CampoTech\apps\web\lib\integrations\whatsapp\providers\dialog360.provider.ts:54:58)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

    [0m [90m 470 |[39m       }[33m;[39m
     [90m 471 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 472 |[39m       console[33m.[39merror([32m'[Dialog360] Error sending 
message:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 473 |[39m       [36mreturn[39m {
     [90m 474 |[39m         success[33m:[39m [36mfalse[39m[33m,[39m
     [90m 475 |[39m         error[33m:[39m error [36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Unknown error'[39m[33m,[39m[0m

      at Dialog360Provider.<anonymous> 
(apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:472:15)
          at Generator.throw (<anonymous>)
      at rejected (apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:55:65)

    console.warn
      [Dialog360] No channel found for organization: org123

    [0m [90m 234 |[39m
     [90m 235 |[39m       [36mif[39m ([33m![39maccount[33m?[39m[33m.[39mbspAccountId) {
    [31m[1m>[22m[39m[90m 236 |[39m         console[33m.[39mwarn([32m'[Dialog360] No channel 
found for organization:'[39m[33m,[39m organizationId)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 237 |[39m         [36mreturn[39m[33m;[39m
     [90m 238 |[39m       }
     [90m 239 |[39m[0m

      at Dialog360Provider.<anonymous> 
(apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:236:17)
      at fulfilled (apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:54:58)

    console.error
      [Dialog360] Error getting usage stats: TypeError: Cannot read properties of undefined (reading 
'count')
          at Dialog360Provider.<anonymous> 
(D:\projects\CampoTech\apps\web\lib\integrations\whatsapp\providers\dialog360.provider.ts:930:32)
          at Generator.next (<anonymous>)
          at fulfilled 
(D:\projects\CampoTech\apps\web\lib\integrations\whatsapp\providers\dialog360.provider.ts:54:58)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

    [0m [90m 964 |[39m       }[33m;[39m
     [90m 965 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 966 |[39m       console[33m.[39merror([32m'[Dialog360] Error getting 
usage stats:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 967 |[39m       [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m;[39m
     [90m 968 |[39m       [36mreturn[39m {
     [90m 969 |[39m         periodStart[33m:[39m [36mnew[39m 
[33mDate[39m(now[33m.[39mgetFullYear()[33m,[39m now[33m.[39mgetMonth()[33m,[39m 
[35m1[39m)[33m,[39m[0m

      at Dialog360Provider.<anonymous> 
(apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:966:15)
      at fulfilled (apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:54:58)

    console.error
      [Dialog360] Error fetching available numbers: TypeError: Cannot read properties of undefined 
(reading 'map')
          at Dialog360Provider.<anonymous> 
(D:\projects\CampoTech\apps\web\lib\integrations\whatsapp\providers\dialog360.provider.ts:102:27)
          at Generator.next (<anonymous>)
          at fulfilled 
(D:\projects\CampoTech\apps\web\lib\integrations\whatsapp\providers\dialog360.provider.ts:54:58)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

    [0m [90m 113 |[39m       }))[33m;[39m
     [90m 114 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 115 |[39m       console[33m.[39merror([32m'[Dialog360] Error 
fetching available numbers:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 116 |[39m       [36mreturn[39m [][33m;[39m
     [90m 117 |[39m     }
     [90m 118 |[39m   }[0m

      at Dialog360Provider.<anonymous> 
(apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:115:15)
      at fulfilled (apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:54:58)

  ΓùÅ Dialog360Provider ΓÇ║ constructor ΓÇ║ should create provider with correct configuration

    TypeError: provider.getProviderName is not a function

    [0m [90m 49 |[39m     it([32m'should create provider with correct 
configuration'[39m[33m,[39m () [33m=>[39m {
     [90m 50 |[39m       expect(provider)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 51 |[39m       
expect(provider[33m.[39mgetProviderName())[33m.[39mtoBe([32m'360dialog'[39m)[33m;[39m
     [90m    |[39m                       [31m[1m^[22m[39m
     [90m 52 |[39m     })[33m;[39m
     [90m 53 |[39m
     [90m 54 |[39m     it([32m'should have BSP capability enabled'[39m[33m,[39m () [33m=>[39m 
{[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:51:23)

  ΓùÅ Dialog360Provider ΓÇ║ constructor ΓÇ║ should create provider with correct configuration

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ constructor ΓÇ║ should have BSP capability enabled

    TypeError: provider.getCapabilities is not a function

    [0m [90m 53 |[39m
     [90m 54 |[39m     it([32m'should have BSP capability enabled'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 55 |[39m       [36mconst[39m capabilities [33m=[39m 
provider[33m.[39mgetCapabilities()[33m;[39m
     [90m    |[39m                                     [31m[1m^[22m[39m
     [90m 56 |[39m       
expect(capabilities[33m.[39msupportsTemplates)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 57 |[39m       
expect(capabilities[33m.[39msupportsMedia)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 58 |[39m       
expect(capabilities[33m.[39msupportsBroadcast)[33m.[39mtoBe([36mtrue[39m)[33m;[39m[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:55:37)

  ΓùÅ Dialog360Provider ΓÇ║ constructor ΓÇ║ should have BSP capability enabled

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ getAvailableNumbers ΓÇ║ should fetch available numbers from partner API

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: StringContaining "/partner/numbers/available", ObjectContaining {"headers": 
ObjectContaining {"Authorization": "Bearer test_partner_api_key"}}
    Received: "https://hub.360dialog.com/v1/partners/test_partner_id/numbers/available?country=AR", 
{"headers": {"Authorization": "Bearer test_partner_api_key", "Content-Type": "application/json"}, 
"method": "GET"}

    Number of calls: 1

    [0m [90m 74 |[39m       [36mconst[39m numbers [33m=[39m [36mawait[39m 
provider[33m.[39mgetAvailableNumbers([32m'AR'[39m)[33m;[39m
     [90m 75 |[39m
    [31m[1m>[22m[39m[90m 76 |[39m       expect(mockFetch)[33m.[39mtoHaveBeenCalledWith(
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 77 |[39m         
expect[33m.[39mstringContaining([32m'/partner/numbers/available'[39m)[33m,[39m
     [90m 78 |[39m         expect[33m.[39mobjectContaining({
     [90m 79 |[39m           headers[33m:[39m expect[33m.[39mobjectContaining({[0m

      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:76:25
      at fulfilled (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:12:58)

  ΓùÅ Dialog360Provider ΓÇ║ getAvailableNumbers ΓÇ║ should fetch available numbers from partner API

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ getAvailableNumbers ΓÇ║ should handle API errors gracefully

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ getAvailableNumbers ΓÇ║ should filter by country code

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ provisionNumber ΓÇ║ should provision a number successfully

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

    [0m [90m 134 |[39m       })[33m;[39m
     [90m 135 |[39m
    [31m[1m>[22m[39m[90m 136 |[39m       
expect(result[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                              [31m[1m^[22m[39m
     [90m 137 |[39m       
expect(result[33m.[39mnumberId)[33m.[39mtoBe([32m'provisioned_123'[39m)[33m;[39m
     [90m 138 |[39m       
expect(result[33m.[39mstatus)[33m.[39mtoBe([32m'pending_verification'[39m)[33m;[39m
     [90m 139 |[39m     })[33m;[39m[0m

      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:136:30
      at fulfilled (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:12:58)

  ΓùÅ Dialog360Provider ΓÇ║ provisionNumber ΓÇ║ should provision a number successfully

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ provisionNumber ΓÇ║ should handle provisioning failure

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ verifyNumber ΓÇ║ should verify number with OTP code

    TypeError: provider.verifyNumber is not a function

    [0m [90m 162 |[39m       })[33m;[39m
     [90m 163 |[39m
    [31m[1m>[22m[39m[90m 164 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m 
provider[33m.[39mverifyNumber([32m'org123'[39m[33m,[39m [32m'123456'[39m)[33m;[39m
     [90m     |[39m                                     [31m[1m^[22m[39m
     [90m 165 |[39m
     [90m 166 |[39m       expect(result[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 167 |[39m     })[33m;[39m[0m

      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:164:37
      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:15:71
      at Object.<anonymous>.__awaiter (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:11:12)
      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:158:57)

  ΓùÅ Dialog360Provider ΓÇ║ verifyNumber ΓÇ║ should verify number with OTP code

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ verifyNumber ΓÇ║ should handle invalid verification code

    TypeError: provider.verifyNumber is not a function

    [0m [90m 174 |[39m       })[33m;[39m
     [90m 175 |[39m
    [31m[1m>[22m[39m[90m 176 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m 
provider[33m.[39mverifyNumber([32m'org123'[39m[33m,[39m [32m'000000'[39m)[33m;[39m
     [90m     |[39m                                     [31m[1m^[22m[39m
     [90m 177 |[39m
     [90m 178 |[39m       expect(result[33m.[39msuccess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 179 |[39m       
expect(result[33m.[39merror)[33m.[39mtoContain([32m'Invalid'[39m)[33m;[39m[0m

      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:176:37
      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:15:71
      at Object.<anonymous>.__awaiter (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:11:12)
      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:169:62)

  ΓùÅ Dialog360Provider ΓÇ║ verifyNumber ΓÇ║ should handle invalid verification code

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ sendMessage ΓÇ║ should send text message successfully

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

    [0m [90m 206 |[39m       })[33m;[39m
     [90m 207 |[39m
    [31m[1m>[22m[39m[90m 208 |[39m       
expect(result[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                              [31m[1m^[22m[39m
     [90m 209 |[39m       
expect(result[33m.[39mmessageId)[33m.[39mtoBe([32m'wamid.abc123'[39m)[33m;[39m
     [90m 210 |[39m     })[33m;[39m
     [90m 211 |[39m[0m

      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:208:30
      at fulfilled (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:12:58)

  ΓùÅ Dialog360Provider ΓÇ║ sendMessage ΓÇ║ should send text message successfully

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ sendMessage ΓÇ║ should handle message sending failure

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ sendMessage ΓÇ║ should check usage limits before sending

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ verifyWebhookSignature ΓÇ║ should verify valid HMAC-SHA256 signature

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ verifyWebhookSignature ΓÇ║ should reject invalid signature

    RangeError: Input buffers must have the same byte length

    [0m [90m 623 |[39m       [33m:[39m signature[33m;[39m
     [90m 624 |[39m
    [31m[1m>[22m[39m[90m 625 |[39m     [36mreturn[39m crypto[33m.[39mtimingSafeEqual(
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 626 |[39m       [33mBuffer[39m[33m.[39m[36mfrom[39m(expectedSignature)[33m,[39m
     [90m 627 |[39m       [33mBuffer[39m[33m.[39m[36mfrom[39m(actualSignature)
     [90m 628 |[39m     )[33m;[39m[0m

      at Dialog360Provider.verifyWebhookSignature 
(apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:625:19)
      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:273:32)

  ΓùÅ Dialog360Provider ΓÇ║ verifyWebhookSignature ΓÇ║ should reject invalid signature

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ verifyWebhookSignature ΓÇ║ should handle missing sha256 prefix

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

    [0m [90m 284 |[39m
     [90m 285 |[39m       [36mconst[39m isValid [33m=[39m 
provider[33m.[39mverifyWebhookSignature(payload[33m,[39m signatureWithoutPrefix[33m,[39m 
secret)[33m;[39m
    [31m[1m>[22m[39m[90m 286 |[39m       
expect(isValid)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m     |[39m                       [31m[1m^[22m[39m
     [90m 287 |[39m     })[33m;[39m
     [90m 288 |[39m
     [90m 289 |[39m     it([32m'should be timing-safe against timing attacks'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:286:23)

  ΓùÅ Dialog360Provider ΓÇ║ verifyWebhookSignature ΓÇ║ should handle missing sha256 prefix

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ verifyWebhookSignature ΓÇ║ should be timing-safe against timing attacks

    RangeError: Input buffers must have the same byte length

    [0m [90m 623 |[39m       [33m:[39m signature[33m;[39m
     [90m 624 |[39m
    [31m[1m>[22m[39m[90m 625 |[39m     [36mreturn[39m crypto[33m.[39mtimingSafeEqual(
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 626 |[39m       [33mBuffer[39m[33m.[39m[36mfrom[39m(expectedSignature)[33m,[39m
     [90m 627 |[39m       [33mBuffer[39m[33m.[39m[36mfrom[39m(actualSignature)
     [90m 628 |[39m     )[33m;[39m[0m

      at Dialog360Provider.verifyWebhookSignature 
(apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:625:19)
      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:304:16)

  ΓùÅ Dialog360Provider ΓÇ║ verifyWebhookSignature ΓÇ║ should be timing-safe against timing attacks

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ releaseNumber ΓÇ║ should release provisioned number

    TypeError: Cannot read properties of undefined (reading 'success')

    [0m [90m 319 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m 
provider[33m.[39mreleaseNumber([32m'org123'[39m)[33m;[39m
     [90m 320 |[39m
    [31m[1m>[22m[39m[90m 321 |[39m       
expect(result[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                     [31m[1m^[22m[39m
     [90m 322 |[39m       expect(mockFetch)[33m.[39mtoHaveBeenCalledWith(
     [90m 323 |[39m         
expect[33m.[39mstringContaining([32m'/partner/numbers/'[39m)[33m,[39m
     [90m 324 |[39m         expect[33m.[39mobjectContaining({[0m

      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:321:21
      at fulfilled (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:12:58)

  ΓùÅ Dialog360Provider ΓÇ║ releaseNumber ΓÇ║ should release provisioned number

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ getUsageStats ΓÇ║ should fetch usage statistics

    expect(received).toBe(expected) // Object.is equality

    Expected: 150
    Received: 0

    [0m [90m 343 |[39m
     [90m 344 |[39m       expect(stats)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 345 |[39m       
expect(stats[33m.[39mmessagesSent)[33m.[39mtoBe([35m150[39m)[33m;[39m
     [90m     |[39m                                  [31m[1m^[22m[39m
     [90m 346 |[39m     })[33m;[39m
     [90m 347 |[39m   })[33m;[39m
     [90m 348 |[39m[0m

      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:345:34
      at fulfilled (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:12:58)

  ΓùÅ Dialog360Provider ΓÇ║ getUsageStats ΓÇ║ should fetch usage statistics

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ getCapabilities ΓÇ║ should return all provider capabilities

    TypeError: provider.getCapabilities is not a function

    [0m [90m 349 |[39m   describe([32m'getCapabilities'[39m[33m,[39m () [33m=>[39m {
     [90m 350 |[39m     it([32m'should return all provider capabilities'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 351 |[39m       [36mconst[39m capabilities [33m=[39m 
provider[33m.[39mgetCapabilities()[33m;[39m
     [90m     |[39m                                     [31m[1m^[22m[39m
     [90m 352 |[39m
     [90m 353 |[39m       expect(capabilities)[33m.[39mtoEqual({
     [90m 354 |[39m         supportsTemplates[33m:[39m [36mtrue[39m[33m,[39m[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:351:37)

  ΓùÅ Dialog360Provider ΓÇ║ getCapabilities ΓÇ║ should return all provider capabilities

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider Error Handling ΓÇ║ should handle timeout errors

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

    [0m [90m 392 |[39m
     [90m 393 |[39m     expect(result[33m.[39msuccess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 394 |[39m     
expect(result[33m.[39mretryable)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                              [31m[1m^[22m[39m
     [90m 395 |[39m   })[33m;[39m
     [90m 396 |[39m
     [90m 397 |[39m   it([32m'should handle rate limiting'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {[0m

      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:394:30
      at fulfilled (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:12:58)

  ΓùÅ Dialog360Provider Error Handling ΓÇ║ should handle rate limiting

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

    [0m [90m 411 |[39m
     [90m 412 |[39m     expect(result[33m.[39msuccess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 413 |[39m     
expect(result[33m.[39mretryable)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                              [31m[1m^[22m[39m
     [90m 414 |[39m     
expect(result[33m.[39merrorCode)[33m.[39mtoBe([32m'RATE_LIMITED'[39m)[33m;[39m
     [90m 415 |[39m   })[33m;[39m
     [90m 416 |[39m })[33m;[39m[0m

      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:413:30
      at fulfilled (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:12:58)

FAIL apps/mobile/__tests__/consumer/CategoryGrid.test.tsx
  ΓùÅ Test suite failed to run

    Cannot find module '@testing-library/react-native' from 
'apps/mobile/__tests__/consumer/CategoryGrid.test.tsx'

    [0m [90m  8 |[39m
     [90m  9 |[39m [36mimport[39m [33mReact[39m [36mfrom[39m [32m'react'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 10 |[39m [36mimport[39m { render[33m,[39m fireEvent } 
[36mfrom[39m [32m'@testing-library/react-native'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 11 |[39m [36mimport[39m [33mCategoryGrid[39m [36mfrom[39m 
[32m'../../components/consumer/CategoryGrid'[39m[33m;[39m
     [90m 12 |[39m
     [90m 13 |[39m describe([32m'CategoryGrid'[39m[33m,[39m () [33m=>[39m {[0m

      at Resolver._throwModNotFoundError 
(node_modules/.pnpm/jest-resolve@29.7.0/node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (apps/mobile/__tests__/consumer/CategoryGrid.test.tsx:10:1)

Summary of all failing tests
FAIL src/api/public/sdk/openapi.test.ts
  ΓùÅ Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (node_modules/.pnpm/@jest+core@29.7.0_ts-node@1_4b536c4b55983dea7b43151a581ff67c/node
_modules/@jest/core/build/TestScheduler.js:133:18)
      at node_modules/.pnpm/@jest+core@29.7.0_ts-node@1_4b536c4b55983dea7b43151a581ff67c/node_modules/@
jest/core/build/TestScheduler.js:254:19
      at node_modules/.pnpm/emittery@0.13.1/node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (node_modules/.pnpm/emittery@0.13.1/node_modules/emittery/index.js:361:23)

FAIL apps/web/__tests__/whatsapp/client.test.ts
  ΓùÅ Test suite failed to run

    Configuration error:

    Could not locate module @/src/integrations/whatsapp/client mapped as:
    D:\projects\CampoTech\apps\web\$1.

    Please check your configuration for these entries:
    {
      "moduleNameMapper": {
        "/^@\/(.*)$/": "D:\projects\CampoTech\apps\web\$1"
      },
      "resolver": undefined
    }

    [0m [90m  8 |[39m [90m// Using Jest globals[39m
     [90m  9 |[39m [36mimport[39m axios [36mfrom[39m [32m'axios'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 10 |[39m [36mimport[39m { [33mWhatsAppClient[39m } [36mfrom[39m 
[32m'@/src/integrations/whatsapp/client'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 11 |[39m
     [90m 12 |[39m [90m// Mock axios[39m
     [90m 13 |[39m jest[33m.[39mmock([32m'axios'[39m[33m,[39m () [33m=>[39m ({[0m

      at createNoMappedModuleFoundError 
(node_modules/.pnpm/jest-resolve@29.7.0/node_modules/jest-resolve/build/resolver.js:759:17)
      at Object.<anonymous> (apps/web/__tests__/whatsapp/client.test.ts:10:1)

FAIL apps/web/e2e/tests/whatsapp.spec.ts
  ΓùÅ Test suite failed to run

    Cannot find module '@playwright/test' from 'apps/web/e2e/tests/whatsapp.spec.ts'

    [0m [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
    [31m[1m>[22m[39m[90m 12 |[39m [36mimport[39m { test[33m,[39m expect[33m,[39m 
[33mPage[39m } [36mfrom[39m [32m'@playwright/test'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 13 |[39m
     [90m 14 |[39m [90m// Test fixtures[39m
     [90m 15 |[39m [36mconst[39m [33mTEST_USER[39m [33m=[39m {[0m

      at Resolver._throwModNotFoundError 
(node_modules/.pnpm/jest-resolve@29.7.0/node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (apps/web/e2e/tests/whatsapp.spec.ts:12:1)

FAIL apps/web/tests/integration/whatsapp/bsp-flow.test.ts
  ΓùÅ Test suite failed to run

    Vitest cannot be imported in a CommonJS module using require(). Please use "import" instead.

    If you are using "import" in your source code, then it's possible it was bundled into require() 
automatically by your bundler. In that case, do not bundle CommonJS output since it will never work 
with Vitest, or use dynamic import() which is available in all CommonJS modules.

    [0m [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
    [31m[1m>[22m[39m[90m 12 |[39m [36mimport[39m { describe[33m,[39m it[33m,[39m 
expect[33m,[39m vi[33m,[39m beforeEach[33m,[39m afterEach[33m,[39m beforeAll } [36mfrom[39m 
[32m'vitest'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 13 |[39m
     [90m 14 |[39m [90m// Mock environment[39m
     [90m 15 |[39m vi[33m.[39mstubEnv([32m'DIALOG360_PARTNER_API_KEY'[39m[33m,[39m 
[32m'test_partner_key'[39m)[33m;[39m[0m

      at Object.<anonymous> (node_modules/.pnpm/vitest@4.0.16_@opentelemetr_470a0d18cc2b6d8033e671acb56
0b11f/node_modules/vitest/index.cjs:1:109)
      at Object.<anonymous> (apps/web/tests/integration/whatsapp/bsp-flow.test.ts:12:1)

FAIL apps/web/tests/unit/payment-processor.test.ts
  ΓùÅ Test suite failed to run

    Vitest cannot be imported in a CommonJS module using require(). Please use "import" instead.

    If you are using "import" in your source code, then it's possible it was bundled into require() 
automatically by your bundler. In that case, do not bundle CommonJS output since it will never work 
with Vitest, or use dynamic import() which is available in all CommonJS modules.

    [0m [90m 11 |[39m [90m */[39m
     [90m 12 |[39m
    [31m[1m>[22m[39m[90m 13 |[39m [36mimport[39m { vi } [36mfrom[39m 
[32m'vitest'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 14 |[39m
     [90m 15 |[39m [90m// ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓò
ÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ
ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ[39m
     [90m 16 |[39m [90m// TYPES[39m[0m

      at Object.<anonymous> (node_modules/.pnpm/vitest@4.0.16_@opentelemetr_470a0d18cc2b6d8033e671acb56
0b11f/node_modules/vitest/index.cjs:1:109)
      at Object.<anonymous> (apps/web/tests/utils/subscription-test-helpers.ts:13:1)
      at Object.<anonymous> (apps/web/tests/unit/payment-processor.test.ts:13:1)

FAIL apps/web/tests/unit/trial-manager.test.ts
  ΓùÅ Test suite failed to run

    Vitest cannot be imported in a CommonJS module using require(). Please use "import" instead.

    If you are using "import" in your source code, then it's possible it was bundled into require() 
automatically by your bundler. In that case, do not bundle CommonJS output since it will never work 
with Vitest, or use dynamic import() which is available in all CommonJS modules.

    [0m [90m 11 |[39m [90m */[39m
     [90m 12 |[39m
    [31m[1m>[22m[39m[90m 13 |[39m [36mimport[39m { vi } [36mfrom[39m 
[32m'vitest'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 14 |[39m
     [90m 15 |[39m [90m// ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓò
ÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ
ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ[39m
     [90m 16 |[39m [90m// TYPES[39m[0m

      at Object.<anonymous> (node_modules/.pnpm/vitest@4.0.16_@opentelemetr_470a0d18cc2b6d8033e671acb56
0b11f/node_modules/vitest/index.cjs:1:109)
      at Object.<anonymous> (apps/web/tests/utils/subscription-test-helpers.ts:13:1)
      at Object.<anonymous> (apps/web/tests/unit/trial-manager.test.ts:13:1)

FAIL apps/web/tests/unit/verification-manager.test.ts
  ΓùÅ Test suite failed to run

    Vitest cannot be imported in a CommonJS module using require(). Please use "import" instead.

    If you are using "import" in your source code, then it's possible it was bundled into require() 
automatically by your bundler. In that case, do not bundle CommonJS output since it will never work 
with Vitest, or use dynamic import() which is available in all CommonJS modules.

    [0m [90m 11 |[39m [90m */[39m
     [90m 12 |[39m
    [31m[1m>[22m[39m[90m 13 |[39m [36mimport[39m { vi } [36mfrom[39m 
[32m'vitest'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 14 |[39m
     [90m 15 |[39m [90m// ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓò
ÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ
ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ[39m
     [90m 16 |[39m [90m// TYPES[39m[0m

      at Object.<anonymous> (node_modules/.pnpm/vitest@4.0.16_@opentelemetr_470a0d18cc2b6d8033e671acb56
0b11f/node_modules/vitest/index.cjs:1:109)
      at Object.<anonymous> (apps/web/tests/utils/subscription-test-helpers.ts:13:1)
      at Object.<anonymous> (apps/web/tests/unit/verification-manager.test.ts:13:1)

FAIL apps/web/tests/unit/block-manager.test.ts
  ΓùÅ Test suite failed to run

    Vitest cannot be imported in a CommonJS module using require(). Please use "import" instead.

    If you are using "import" in your source code, then it's possible it was bundled into require() 
automatically by your bundler. In that case, do not bundle CommonJS output since it will never work 
with Vitest, or use dynamic import() which is available in all CommonJS modules.

    [0m [90m 11 |[39m [90m */[39m
     [90m 12 |[39m
    [31m[1m>[22m[39m[90m 13 |[39m [36mimport[39m { vi } [36mfrom[39m 
[32m'vitest'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 14 |[39m
     [90m 15 |[39m [90m// ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓò
ÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ
ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ[39m
     [90m 16 |[39m [90m// TYPES[39m[0m

      at Object.<anonymous> (node_modules/.pnpm/vitest@4.0.16_@opentelemetr_470a0d18cc2b6d8033e671acb56
0b11f/node_modules/vitest/index.cjs:1:109)
      at Object.<anonymous> (apps/web/tests/utils/subscription-test-helpers.ts:13:1)
      at Object.<anonymous> (apps/web/tests/unit/block-manager.test.ts:13:1)

FAIL apps/web/tests/integration/subscription-flow.test.ts
  ΓùÅ Test suite failed to run

    Vitest cannot be imported in a CommonJS module using require(). Please use "import" instead.

    If you are using "import" in your source code, then it's possible it was bundled into require() 
automatically by your bundler. In that case, do not bundle CommonJS output since it will never work 
with Vitest, or use dynamic import() which is available in all CommonJS modules.

    [0m [90m 11 |[39m [90m */[39m
     [90m 12 |[39m
    [31m[1m>[22m[39m[90m 13 |[39m [36mimport[39m { vi } [36mfrom[39m 
[32m'vitest'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 14 |[39m
     [90m 15 |[39m [90m// ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓò
ÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ
ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ[39m
     [90m 16 |[39m [90m// TYPES[39m[0m

      at Object.<anonymous> (node_modules/.pnpm/vitest@4.0.16_@opentelemetr_470a0d18cc2b6d8033e671acb56
0b11f/node_modules/vitest/index.cjs:1:109)
      at Object.<anonymous> (apps/web/tests/utils/subscription-test-helpers.ts:13:1)
      at Object.<anonymous> (apps/web/tests/integration/subscription-flow.test.ts:13:1)

FAIL apps/web/e2e/tests/admin.spec.ts
  ΓùÅ Test suite failed to run

    Cannot find module '@playwright/test' from 'apps/web/e2e/tests/admin.spec.ts'

    [0m [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
    [31m[1m>[22m[39m[90m 12 |[39m [36mimport[39m { test[33m,[39m expect[33m,[39m 
[33mPage[39m } [36mfrom[39m [32m'@playwright/test'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 13 |[39m
     [90m 14 |[39m [90m// Admin test credentials (would be configured in test environment)[39m
     [90m 15 |[39m [36mconst[39m [33mADMIN_USER[39m [33m=[39m {[0m

      at Resolver._throwModNotFoundError 
(node_modules/.pnpm/jest-resolve@29.7.0/node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (apps/web/e2e/tests/admin.spec.ts:12:1)

FAIL apps/web/tests/unit/whatsapp/provisioning.test.ts
  ΓùÅ Test suite failed to run

    ReferenceError: vi is not defined

    [0m [90m 41 |[39m [90m// Mock the provider factory to return the shared instance[39m
     [90m 42 |[39m jest[33m.[39mmock([32m'@/lib/integrations/whatsapp/providers'[39m[33m,[39m 
() [33m=>[39m ({
    [31m[1m>[22m[39m[90m 43 |[39m   getBSPProvider[33m:[39m vi[33m.[39mfn(() [33m=>[39m 
mockProvider)[33m,[39m
     [90m    |[39m                   [31m[1m^[22m[39m
     [90m 44 |[39m }))[33m;[39m
     [90m 45 |[39m
     [90m 46 |[39m [90m// Import mocked modules[39m[0m

      at apps/web/tests/unit/whatsapp/provisioning.test.ts:43:19
      at Object.<anonymous> (apps/web/tests/unit/whatsapp/provisioning.test.ts:48:1)

FAIL apps/web/tests/unit/access-control.test.ts
  ΓùÅ Test suite failed to run

    Vitest cannot be imported in a CommonJS module using require(). Please use "import" instead.

    If you are using "import" in your source code, then it's possible it was bundled into require() 
automatically by your bundler. In that case, do not bundle CommonJS output since it will never work 
with Vitest, or use dynamic import() which is available in all CommonJS modules.

    [0m [90m 11 |[39m [90m */[39m
     [90m 12 |[39m
    [31m[1m>[22m[39m[90m 13 |[39m [36mimport[39m { vi } [36mfrom[39m 
[32m'vitest'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 14 |[39m
     [90m 15 |[39m [90m// ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓò
ÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ
ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ[39m
     [90m 16 |[39m [90m// TYPES[39m[0m

      at Object.<anonymous> (node_modules/.pnpm/vitest@4.0.16_@opentelemetr_470a0d18cc2b6d8033e671acb56
0b11f/node_modules/vitest/index.cjs:1:109)
      at Object.<anonymous> (apps/web/tests/utils/subscription-test-helpers.ts:13:1)
      at Object.<anonymous> (apps/web/tests/unit/access-control.test.ts:12:1)

FAIL apps/web/tests/unit/afip-client.test.ts
  ΓùÅ Test suite failed to run

    Vitest cannot be imported in a CommonJS module using require(). Please use "import" instead.

    If you are using "import" in your source code, then it's possible it was bundled into require() 
automatically by your bundler. In that case, do not bundle CommonJS output since it will never work 
with Vitest, or use dynamic import() which is available in all CommonJS modules.

    [0m [90m 11 |[39m [90m */[39m
     [90m 12 |[39m
    [31m[1m>[22m[39m[90m 13 |[39m [36mimport[39m { vi } [36mfrom[39m 
[32m'vitest'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 14 |[39m
     [90m 15 |[39m [90m// ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓò
ÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ
ΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉΓòÉ[39m
     [90m 16 |[39m [90m// TYPES[39m[0m

      at Object.<anonymous> (node_modules/.pnpm/vitest@4.0.16_@opentelemetr_470a0d18cc2b6d8033e671acb56
0b11f/node_modules/vitest/index.cjs:1:109)
      at Object.<anonymous> (apps/web/tests/utils/subscription-test-helpers.ts:13:1)
      at Object.<anonymous> (apps/web/tests/unit/afip-client.test.ts:12:1)

FAIL apps/web/__tests__/whatsapp/webhook.test.ts
  ΓùÅ Test suite failed to run

    Configuration error:

    Could not locate module @/src/integrations/whatsapp/webhook/webhook.handler mapped as:
    D:\projects\CampoTech\apps\web\$1.

    Please check your configuration for these entries:
    {
      "moduleNameMapper": {
        "/^@\/(.*)$/": "D:\projects\CampoTech\apps\web\$1"
      },
      "resolver": undefined
    }

    [0m [90m  8 |[39m [90m// Using Jest globals[39m
     [90m  9 |[39m [36mimport[39m crypto [36mfrom[39m [32m'crypto'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 10 |[39m [36mimport[39m {
     [90m    |[39m [31m[1m^[22m[39m
     [90m 11 |[39m   validateWebhookSignature[33m,[39m
     [90m 12 |[39m   verifyWebhook[33m,[39m
     [90m 13 |[39m   parseWebhookPayload[33m,[39m[0m

      at createNoMappedModuleFoundError 
(node_modules/.pnpm/jest-resolve@29.7.0/node_modules/jest-resolve/build/resolver.js:759:17)
      at Object.<anonymous> (apps/web/__tests__/whatsapp/webhook.test.ts:10:1)

FAIL apps/web/e2e/tests/subscription.spec.ts
  ΓùÅ Test suite failed to run

    Cannot find module '@playwright/test' from 'apps/web/e2e/tests/subscription.spec.ts'

    [0m [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
    [31m[1m>[22m[39m[90m 12 |[39m [36mimport[39m { test[33m,[39m expect[33m,[39m 
[33mPage[39m } [36mfrom[39m [32m'@playwright/test'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 13 |[39m
     [90m 14 |[39m [90m// Test fixtures[39m
     [90m 15 |[39m [36mconst[39m [33mTEST_USER[39m [33m=[39m {[0m

      at Resolver._throwModNotFoundError 
(node_modules/.pnpm/jest-resolve@29.7.0/node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (apps/web/e2e/tests/subscription.spec.ts:12:1)

FAIL apps/web/__tests__/whatsapp/notifications.test.ts
  ΓùÅ Test suite failed to run

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard 
JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based 
on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     ΓÇó If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules 
for how to enable it.
     ΓÇó If you are trying to use TypeScript, see 
https://jestjs.io/docs/getting-started#using-typescript
     ΓÇó To have some of your "node_modules" files transformed, you can specify a custom 
"transformIgnorePatterns" in your config.
     ΓÇó If you need a custom transformation specify a "transform" option in your config.
     ΓÇó If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out 
with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    D:\projects\CampoTech\apps\web\__tests__\whatsapp\notifications.test.ts:40
    const { jest } = require('@jest/globals');
            ^

    SyntaxError: Identifier 'jest' has already been declared

      at Runtime.createScriptFromCode 
(node_modules/.pnpm/jest-runtime@29.7.0/node_modules/jest-runtime/build/index.js:1505:14)

FAIL src/modules/consumer/__tests__/fraud-detection.service.test.ts
  ΓùÅ FraudDetectionService ΓÇ║ Text similarity detection ΓÇ║ should detect similar text with minor 
differences

    expect(received).toBeGreaterThan(expected)

    Expected: > 0.5
    Received:   0.25

    [0m [90m 62 |[39m       )[33m;[39m
     [90m 63 |[39m
    [31m[1m>[22m[39m[90m 64 |[39m       
expect(similarity)[33m.[39mtoBeGreaterThan([35m0.5[39m)[33m;[39m
     [90m    |[39m                          [31m[1m^[22m[39m
     [90m 65 |[39m     })[33m;[39m
     [90m 66 |[39m
     [90m 67 |[39m     it([32m'should detect different texts as dissimilar'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.<anonymous> (src/modules/consumer/__tests__/fraud-detection.service.test.ts:64:26)

  ΓùÅ FraudDetectionService ΓÇ║ Analysis calculation ΓÇ║ should recommend auto_reject for high fraud 
score

    expect(received).toBe(expected) // Object.is equality

    Expected: "auto_reject"
    Received: "manual_review"

    [0m [90m 209 |[39m       [36mconst[39m result [33m=[39m 
calculateAnalysis([32m'review-id'[39m[33m,[39m signals)[33m;[39m
     [90m 210 |[39m
    [31m[1m>[22m[39m[90m 211 |[39m       
expect(result[33m.[39mrecommendation)[33m.[39mtoBe([32m'auto_reject'[39m)[33m;[39m
     [90m     |[39m                                     [31m[1m^[22m[39m
     [90m 212 |[39m       
expect(result[33m.[39moverallScore)[33m.[39mtoBeGreaterThanOrEqual([35m70[39m)[33m;[39m
     [90m 213 |[39m     })[33m;[39m
     [90m 214 |[39m[0m

      at Object.<anonymous> (src/modules/consumer/__tests__/fraud-detection.service.test.ts:211:37)

FAIL apps/mobile/__tests__/consumer/BusinessCard.test.tsx
  ΓùÅ Test suite failed to run

    Cannot find module '@testing-library/react-native' from 
'apps/mobile/__tests__/consumer/BusinessCard.test.tsx'

    [0m [90m  8 |[39m
     [90m  9 |[39m [36mimport[39m [33mReact[39m [36mfrom[39m [32m'react'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 10 |[39m [36mimport[39m { render[33m,[39m fireEvent } 
[36mfrom[39m [32m'@testing-library/react-native'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 11 |[39m [36mimport[39m [33mBusinessCard[39m [36mfrom[39m 
[32m'../../components/consumer/BusinessCard'[39m[33m;[39m
     [90m 12 |[39m
     [90m 13 |[39m describe([32m'BusinessCard'[39m[33m,[39m () [33m=>[39m {[0m

      at Resolver._throwModNotFoundError 
(node_modules/.pnpm/jest-resolve@29.7.0/node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (apps/mobile/__tests__/consumer/BusinessCard.test.tsx:10:1)

FAIL apps/web/tests/unit/whatsapp/dialog360-provider.test.ts (6.902 s)
  ΓùÅ Dialog360Provider ΓÇ║ constructor ΓÇ║ should create provider with correct configuration

    TypeError: provider.getProviderName is not a function

    [0m [90m 49 |[39m     it([32m'should create provider with correct 
configuration'[39m[33m,[39m () [33m=>[39m {
     [90m 50 |[39m       expect(provider)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 51 |[39m       
expect(provider[33m.[39mgetProviderName())[33m.[39mtoBe([32m'360dialog'[39m)[33m;[39m
     [90m    |[39m                       [31m[1m^[22m[39m
     [90m 52 |[39m     })[33m;[39m
     [90m 53 |[39m
     [90m 54 |[39m     it([32m'should have BSP capability enabled'[39m[33m,[39m () [33m=>[39m 
{[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:51:23)

  ΓùÅ Dialog360Provider ΓÇ║ constructor ΓÇ║ should create provider with correct configuration

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ constructor ΓÇ║ should have BSP capability enabled

    TypeError: provider.getCapabilities is not a function

    [0m [90m 53 |[39m
     [90m 54 |[39m     it([32m'should have BSP capability enabled'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 55 |[39m       [36mconst[39m capabilities [33m=[39m 
provider[33m.[39mgetCapabilities()[33m;[39m
     [90m    |[39m                                     [31m[1m^[22m[39m
     [90m 56 |[39m       
expect(capabilities[33m.[39msupportsTemplates)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 57 |[39m       
expect(capabilities[33m.[39msupportsMedia)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 58 |[39m       
expect(capabilities[33m.[39msupportsBroadcast)[33m.[39mtoBe([36mtrue[39m)[33m;[39m[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:55:37)

  ΓùÅ Dialog360Provider ΓÇ║ constructor ΓÇ║ should have BSP capability enabled

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ getAvailableNumbers ΓÇ║ should fetch available numbers from partner API

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: StringContaining "/partner/numbers/available", ObjectContaining {"headers": 
ObjectContaining {"Authorization": "Bearer test_partner_api_key"}}
    Received: "https://hub.360dialog.com/v1/partners/test_partner_id/numbers/available?country=AR", 
{"headers": {"Authorization": "Bearer test_partner_api_key", "Content-Type": "application/json"}, 
"method": "GET"}

    Number of calls: 1

    [0m [90m 74 |[39m       [36mconst[39m numbers [33m=[39m [36mawait[39m 
provider[33m.[39mgetAvailableNumbers([32m'AR'[39m)[33m;[39m
     [90m 75 |[39m
    [31m[1m>[22m[39m[90m 76 |[39m       expect(mockFetch)[33m.[39mtoHaveBeenCalledWith(
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 77 |[39m         
expect[33m.[39mstringContaining([32m'/partner/numbers/available'[39m)[33m,[39m
     [90m 78 |[39m         expect[33m.[39mobjectContaining({
     [90m 79 |[39m           headers[33m:[39m expect[33m.[39mobjectContaining({[0m

      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:76:25
      at fulfilled (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:12:58)

  ΓùÅ Dialog360Provider ΓÇ║ getAvailableNumbers ΓÇ║ should fetch available numbers from partner API

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ getAvailableNumbers ΓÇ║ should handle API errors gracefully

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ getAvailableNumbers ΓÇ║ should filter by country code

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ provisionNumber ΓÇ║ should provision a number successfully

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

    [0m [90m 134 |[39m       })[33m;[39m
     [90m 135 |[39m
    [31m[1m>[22m[39m[90m 136 |[39m       
expect(result[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                              [31m[1m^[22m[39m
     [90m 137 |[39m       
expect(result[33m.[39mnumberId)[33m.[39mtoBe([32m'provisioned_123'[39m)[33m;[39m
     [90m 138 |[39m       
expect(result[33m.[39mstatus)[33m.[39mtoBe([32m'pending_verification'[39m)[33m;[39m
     [90m 139 |[39m     })[33m;[39m[0m

      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:136:30
      at fulfilled (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:12:58)

  ΓùÅ Dialog360Provider ΓÇ║ provisionNumber ΓÇ║ should provision a number successfully

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ provisionNumber ΓÇ║ should handle provisioning failure

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ verifyNumber ΓÇ║ should verify number with OTP code

    TypeError: provider.verifyNumber is not a function

    [0m [90m 162 |[39m       })[33m;[39m
     [90m 163 |[39m
    [31m[1m>[22m[39m[90m 164 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m 
provider[33m.[39mverifyNumber([32m'org123'[39m[33m,[39m [32m'123456'[39m)[33m;[39m
     [90m     |[39m                                     [31m[1m^[22m[39m
     [90m 165 |[39m
     [90m 166 |[39m       expect(result[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 167 |[39m     })[33m;[39m[0m

      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:164:37
      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:15:71
      at Object.<anonymous>.__awaiter (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:11:12)
      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:158:57)

  ΓùÅ Dialog360Provider ΓÇ║ verifyNumber ΓÇ║ should verify number with OTP code

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ verifyNumber ΓÇ║ should handle invalid verification code

    TypeError: provider.verifyNumber is not a function

    [0m [90m 174 |[39m       })[33m;[39m
     [90m 175 |[39m
    [31m[1m>[22m[39m[90m 176 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m 
provider[33m.[39mverifyNumber([32m'org123'[39m[33m,[39m [32m'000000'[39m)[33m;[39m
     [90m     |[39m                                     [31m[1m^[22m[39m
     [90m 177 |[39m
     [90m 178 |[39m       expect(result[33m.[39msuccess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 179 |[39m       
expect(result[33m.[39merror)[33m.[39mtoContain([32m'Invalid'[39m)[33m;[39m[0m

      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:176:37
      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:15:71
      at Object.<anonymous>.__awaiter (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:11:12)
      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:169:62)

  ΓùÅ Dialog360Provider ΓÇ║ verifyNumber ΓÇ║ should handle invalid verification code

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ sendMessage ΓÇ║ should send text message successfully

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

    [0m [90m 206 |[39m       })[33m;[39m
     [90m 207 |[39m
    [31m[1m>[22m[39m[90m 208 |[39m       
expect(result[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                              [31m[1m^[22m[39m
     [90m 209 |[39m       
expect(result[33m.[39mmessageId)[33m.[39mtoBe([32m'wamid.abc123'[39m)[33m;[39m
     [90m 210 |[39m     })[33m;[39m
     [90m 211 |[39m[0m

      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:208:30
      at fulfilled (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:12:58)

  ΓùÅ Dialog360Provider ΓÇ║ sendMessage ΓÇ║ should send text message successfully

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ sendMessage ΓÇ║ should handle message sending failure

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ sendMessage ΓÇ║ should check usage limits before sending

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ verifyWebhookSignature ΓÇ║ should verify valid HMAC-SHA256 signature

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ verifyWebhookSignature ΓÇ║ should reject invalid signature

    RangeError: Input buffers must have the same byte length

    [0m [90m 623 |[39m       [33m:[39m signature[33m;[39m
     [90m 624 |[39m
    [31m[1m>[22m[39m[90m 625 |[39m     [36mreturn[39m crypto[33m.[39mtimingSafeEqual(
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 626 |[39m       [33mBuffer[39m[33m.[39m[36mfrom[39m(expectedSignature)[33m,[39m
     [90m 627 |[39m       [33mBuffer[39m[33m.[39m[36mfrom[39m(actualSignature)
     [90m 628 |[39m     )[33m;[39m[0m

      at Dialog360Provider.verifyWebhookSignature 
(apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:625:19)
      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:273:32)

  ΓùÅ Dialog360Provider ΓÇ║ verifyWebhookSignature ΓÇ║ should reject invalid signature

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ verifyWebhookSignature ΓÇ║ should handle missing sha256 prefix

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

    [0m [90m 284 |[39m
     [90m 285 |[39m       [36mconst[39m isValid [33m=[39m 
provider[33m.[39mverifyWebhookSignature(payload[33m,[39m signatureWithoutPrefix[33m,[39m 
secret)[33m;[39m
    [31m[1m>[22m[39m[90m 286 |[39m       
expect(isValid)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m     |[39m                       [31m[1m^[22m[39m
     [90m 287 |[39m     })[33m;[39m
     [90m 288 |[39m
     [90m 289 |[39m     it([32m'should be timing-safe against timing attacks'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:286:23)

  ΓùÅ Dialog360Provider ΓÇ║ verifyWebhookSignature ΓÇ║ should handle missing sha256 prefix

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ verifyWebhookSignature ΓÇ║ should be timing-safe against timing attacks

    RangeError: Input buffers must have the same byte length

    [0m [90m 623 |[39m       [33m:[39m signature[33m;[39m
     [90m 624 |[39m
    [31m[1m>[22m[39m[90m 625 |[39m     [36mreturn[39m crypto[33m.[39mtimingSafeEqual(
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 626 |[39m       [33mBuffer[39m[33m.[39m[36mfrom[39m(expectedSignature)[33m,[39m
     [90m 627 |[39m       [33mBuffer[39m[33m.[39m[36mfrom[39m(actualSignature)
     [90m 628 |[39m     )[33m;[39m[0m

      at Dialog360Provider.verifyWebhookSignature 
(apps/web/lib/integrations/whatsapp/providers/dialog360.provider.ts:625:19)
      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:304:16)

  ΓùÅ Dialog360Provider ΓÇ║ verifyWebhookSignature ΓÇ║ should be timing-safe against timing attacks

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ releaseNumber ΓÇ║ should release provisioned number

    TypeError: Cannot read properties of undefined (reading 'success')

    [0m [90m 319 |[39m       [36mconst[39m result [33m=[39m [36mawait[39m 
provider[33m.[39mreleaseNumber([32m'org123'[39m)[33m;[39m
     [90m 320 |[39m
    [31m[1m>[22m[39m[90m 321 |[39m       
expect(result[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                     [31m[1m^[22m[39m
     [90m 322 |[39m       expect(mockFetch)[33m.[39mtoHaveBeenCalledWith(
     [90m 323 |[39m         
expect[33m.[39mstringContaining([32m'/partner/numbers/'[39m)[33m,[39m
     [90m 324 |[39m         expect[33m.[39mobjectContaining({[0m

      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:321:21
      at fulfilled (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:12:58)

  ΓùÅ Dialog360Provider ΓÇ║ releaseNumber ΓÇ║ should release provisioned number

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ getUsageStats ΓÇ║ should fetch usage statistics

    expect(received).toBe(expected) // Object.is equality

    Expected: 150
    Received: 0

    [0m [90m 343 |[39m
     [90m 344 |[39m       expect(stats)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 345 |[39m       
expect(stats[33m.[39mmessagesSent)[33m.[39mtoBe([35m150[39m)[33m;[39m
     [90m     |[39m                                  [31m[1m^[22m[39m
     [90m 346 |[39m     })[33m;[39m
     [90m 347 |[39m   })[33m;[39m
     [90m 348 |[39m[0m

      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:345:34
      at fulfilled (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:12:58)

  ΓùÅ Dialog360Provider ΓÇ║ getUsageStats ΓÇ║ should fetch usage statistics

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider ΓÇ║ getCapabilities ΓÇ║ should return all provider capabilities

    TypeError: provider.getCapabilities is not a function

    [0m [90m 349 |[39m   describe([32m'getCapabilities'[39m[33m,[39m () [33m=>[39m {
     [90m 350 |[39m     it([32m'should return all provider capabilities'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 351 |[39m       [36mconst[39m capabilities [33m=[39m 
provider[33m.[39mgetCapabilities()[33m;[39m
     [90m     |[39m                                     [31m[1m^[22m[39m
     [90m 352 |[39m
     [90m 353 |[39m       expect(capabilities)[33m.[39mtoEqual({
     [90m 354 |[39m         supportsTemplates[33m:[39m [36mtrue[39m[33m,[39m[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:351:37)

  ΓùÅ Dialog360Provider ΓÇ║ getCapabilities ΓÇ║ should return all provider capabilities

    ReferenceError: vi is not defined

    [0m [90m 43 |[39m
     [90m 44 |[39m   afterEach(() [33m=>[39m {
    [31m[1m>[22m[39m[90m 45 |[39m     vi[33m.[39mrestoreAllMocks()[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 46 |[39m   })[33m;[39m
     [90m 47 |[39m
     [90m 48 |[39m   describe([32m'constructor'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:45:5)

  ΓùÅ Dialog360Provider Error Handling ΓÇ║ should handle timeout errors

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

    [0m [90m 392 |[39m
     [90m 393 |[39m     expect(result[33m.[39msuccess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 394 |[39m     
expect(result[33m.[39mretryable)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                              [31m[1m^[22m[39m
     [90m 395 |[39m   })[33m;[39m
     [90m 396 |[39m
     [90m 397 |[39m   it([32m'should handle rate limiting'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {[0m

      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:394:30
      at fulfilled (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:12:58)

  ΓùÅ Dialog360Provider Error Handling ΓÇ║ should handle rate limiting

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

    [0m [90m 411 |[39m
     [90m 412 |[39m     expect(result[33m.[39msuccess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 413 |[39m     
expect(result[33m.[39mretryable)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                              [31m[1m^[22m[39m
     [90m 414 |[39m     
expect(result[33m.[39merrorCode)[33m.[39mtoBe([32m'RATE_LIMITED'[39m)[33m;[39m
     [90m 415 |[39m   })[33m;[39m
     [90m 416 |[39m })[33m;[39m[0m

      at apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:413:30
      at fulfilled (apps/web/tests/unit/whatsapp/dialog360-provider.test.ts:12:58)

FAIL apps/mobile/__tests__/consumer/CategoryGrid.test.tsx
  ΓùÅ Test suite failed to run

    Cannot find module '@testing-library/react-native' from 
'apps/mobile/__tests__/consumer/CategoryGrid.test.tsx'

    [0m [90m  8 |[39m
     [90m  9 |[39m [36mimport[39m [33mReact[39m [36mfrom[39m [32m'react'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 10 |[39m [36mimport[39m { render[33m,[39m fireEvent } 
[36mfrom[39m [32m'@testing-library/react-native'[39m[33m;[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 11 |[39m [36mimport[39m [33mCategoryGrid[39m [36mfrom[39m 
[32m'../../components/consumer/CategoryGrid'[39m[33m;[39m
     [90m 12 |[39m
     [90m 13 |[39m describe([32m'CategoryGrid'[39m[33m,[39m () [33m=>[39m {[0m

      at Resolver._throwModNotFoundError 
(node_modules/.pnpm/jest-resolve@29.7.0/node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (apps/mobile/__tests__/consumer/CategoryGrid.test.tsx:10:1)


Test Suites: 20 failed, 6 passed, 26 total
Tests:       23 failed, 246 passed, 269 total
Snapshots:   0 total
Time:        10.287 s
Ran all test suites.
ΓÇëELIFECYCLEΓÇë Test failed. See above for more details.
