# 1.2 CERT-AR / Cybersecurity Breach Notification (Res. 580/2011 + Convenio 108+)

## Inventario Completo de Datos Sensibles en Base de Datos

> **Prop√≥sito:** Este documento contiene el listado completo y exhaustivo de toda la informaci√≥n almacenada en la base de datos de CampoTech que ser√≠a objeto de notificaci√≥n en caso de brecha de seguridad, conforme a:
> - **Res. 580/2011** (Disposici√≥n CERT-AR)
> - **Convenio 108+** (Ley N¬∞ 27.699, ratificada 2022)
> - **Resoluci√≥n AAIP 47/2018** (mejores pr√°cticas de notificaci√≥n)
> - **Resoluci√≥n 126/2024 AAIP** (r√©gimen sancionatorio unificado)
> - **Ley 25.326** (Protecci√≥n de Datos Personales)
> - **Proyecto de Ley de Protecci√≥n de Datos Personales** (en tr√°mite parlamentario)

> **Fuente de datos:** `apps/web/prisma/schema.prisma` (5,173 l√≠neas, 210 modelos)

---

## Clasificaci√≥n de Riesgo

| Nivel | Significado | Plazo de Notificaci√≥n (Convenio 108+) |
|-------|-------------|---------------------------------------|
| üî¥ **CR√çTICO** | Claves criptogr√°ficas, credenciales de acceso, datos que permiten suplantaci√≥n de identidad fiscal | **Inmediato** (< 24 horas) |
| üü† **ALTO** | Datos personales identificables (PII), datos financieros, ubicaci√≥n en tiempo real | **72 horas** |
| üü° **MEDIO** | Datos de comunicaci√≥n, metadata operacional, datos de negocio | **72 horas** (seg√∫n impacto) |
| üü¢ **BAJO** | Datos operacionales no identificables, configuraciones, estad√≠sticas | Evaluar caso por caso |

---

## 1. üî¥ CREDENCIALES CRIPTOGR√ÅFICAS Y SECRETOS (RIESGO CR√çTICO)

> **Impacto de brecha:** Un atacante podr√≠a emitir facturas electr√≥nicas fraudulentas ante AFIP en nombre de organizaciones clientes. Constituye delito penal (falsificaci√≥n de documento p√∫blico electr√≥nico).

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB | Riesgo Espec√≠fico |
|---|------|---------------|----------|----------|-------------------|
| 1.1 | **Certificado digital AFIP (cifrado)** | `Organization` | `afipCertificateEncrypted` | `organizations` | Clave p√∫blica del certificado AFIP ‚Äî permite emisi√≥n de facturas electr√≥nicas |
| 1.2 | **Clave privada AFIP (cifrada)** | `Organization` | `afipPrivateKeyEncrypted` | `organizations` | ‚ö†Ô∏è **M√ÅXIMO RIESGO** ‚Äî con esta clave se firman facturas electr√≥nicas v√°lidas ante AFIP |
| 1.3 | **CUIT de organizaci√≥n** | `Organization` | `cuit` | `organizations` | Identificador fiscal un√≠voco ‚Äî combinado con 1.1/1.2 permite suplantaci√≥n total |
| 1.4 | **Token de acceso WhatsApp Business API** | `WhatsAppBusinessAccount` | `accessToken` | `whatsapp_business_accounts` | Permite enviar mensajes en nombre del negocio |
| 1.5 | **Secreto de webhook WhatsApp** | `WhatsAppBusinessAccount` | `webhookSecret` | `whatsapp_business_accounts` | Permite inyectar webhooks falsos |
| 1.6 | **Token de verificaci√≥n webhook** | `WhatsAppBusinessAccount` | `webhookVerifyToken` | `whatsapp_business_accounts` | Permite configurar endpoints de webhook maliciosos |
| 1.7 | **C√≥digo de verificaci√≥n WhatsApp** | `WhatsAppBusinessAccount` | `verificationCode` | `whatsapp_business_accounts` | Permite tomar control de n√∫mero de WhatsApp Business |
| 1.8 | **Hash de contrase√±a de usuario** | `User` | `passwordHash` | `users` | Susceptible a rainbow tables / fuerza bruta offline |
| 1.9 | **Hash de token de refresco** | `RefreshToken` | `tokenHash` | `refresh_tokens` | Permite hijack de sesiones activas |
| 1.10 | **Hash de c√≥digo OTP** | `OtpCode` | `codeHash` | `otp_codes` | Permite bypass de autenticaci√≥n (si c√≥digo no expirado) |
| 1.11 | **Token de badge digital** | `User` | `badgeToken` | `users` | Permite suplantaci√≥n de identidad de t√©cnico en sitio |
| 1.12 | **Token de tracking** | `TrackingToken` | `token` | `tracking_tokens` | Permite acceso no autorizado a ubicaci√≥n en tiempo real |
| 1.13 | **Token de descarga de exportaci√≥n** | `ExportRequest` | `downloadToken` | `export_requests` | Permite descarga de datos exportados del cliente |
| 1.14 | **Token de descarga ARCO** | `DataAccessRequest` | `downloadToken` | `data_access_requests` | Permite descarga de paquete completo de datos personales |
| 1.15 | **Token de reclamo de perfil** | `UnclaimedProfile` | `claimToken` | `unclaimed_profiles` | Permite tomar control de perfil profesional no reclamado |
| 1.16 | **Token de rese√±a** | `Review` | `token` | `reviews` | Permite enviar rese√±as falsas |
| 1.17 | **C√≥digo de verificaci√≥n de empleado** | `EmployeeVerificationToken` | `code` | `employee_verification_tokens` | Permite verificar identidad sin autorizaci√≥n |
| 1.18 | **C√≥digo de confirmaci√≥n de trabajo** | `Job` | `confirmationCode` | `jobs` | Permite verificar llegada de t√©cnico sin estar presente |
| 1.19 | **C√≥digo de verificaci√≥n ARCO** | `DataAccessRequest` | `verificationCode` | `data_access_requests` | Permite acceder a datos de clientes sin autorizaci√≥n |

---

## 2. üü† DATOS PERSONALES IDENTIFICABLES ‚Äî PII (RIESGO ALTO)

### 2.1 Identidad de Usuarios Internos (Empleados/T√©cnicos)

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 2.1.1 | **Nombre completo** | `User` | `name` | `users` |
| 2.1.2 | **Email** | `User` | `email` | `users` |
| 2.1.3 | **Tel√©fono** | `User` | `phone` | `users` |
| 2.1.4 | **Foto de avatar** | `User` | `avatar` | `users` |
| 2.1.5 | **Especialidades profesionales** | `User` | `specialties`, `specialty` | `users` |
| 2.1.6 | **Certificaciones (incluye matr√≠culas)** | `User` | `certifications` (JSON) | `users` |
| 2.1.7 | **Nivel de habilidad** | `User` | `skillLevel` | `users` |
| 2.1.8 | **Nivel UOCRA** | `User` | `uocraLevel` | `users` |
| 2.1.9 | **Tarifa horaria personalizada** | `User` | `hourlyRateOverride` | `users` |
| 2.1.10 | **N√∫mero de licencia de conducir** | `User` | `driverLicenseNumber` | `users` |
| 2.1.11 | **Categor√≠a de licencia de conducir** | `User` | `driverLicenseCategory` | `users` |
| 2.1.12 | **Vencimiento de licencia de conducir** | `User` | `driverLicenseExpiry` | `users` |
| 2.1.13 | **URL de certificado ART** | `User` | `artCertificateUrl` | `users` |
| 2.1.14 | **Proveedor ART** | `User` | `artProvider` | `users` |
| 2.1.15 | **N√∫mero de p√≥liza ART** | `User` | `artPolicyNumber` | `users` |
| 2.1.16 | **Estado de verificaci√≥n de antecedentes** | `User` | `backgroundCheckStatus` | `users` |
| 2.1.17 | **Proveedor de verificaci√≥n de antecedentes** | `User` | `backgroundCheckProvider` | `users` |
| 2.1.18 | **Estado de verificaci√≥n de identidad** | `User` | `identityVerified`, `verificationStatus` | `users` |

### 2.2 Identidad de Clientes

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 2.2.1 | **Nombre completo** | `Customer` | `name` | `customers` |
| 2.2.2 | **Tel√©fono** | `Customer` | `phone` | `customers` |
| 2.2.3 | **Email** | `Customer` | `email` | `customers` |
| 2.2.4 | **Direcci√≥n (JSON estructurado)** | `Customer` | `address` | `customers` |
| 2.2.5 | **Notas (texto libre, puede contener PII)** | `Customer` | `notes` | `customers` |
| 2.2.6 | **Tipo de cliente** | `Customer` | `customerType` | `customers` |
| 2.2.7 | **Estado VIP** | `Customer` | `isVip` | `customers` |

### 2.3 Identidad de Organizaciones

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 2.3.1 | **Nombre de organizaci√≥n** | `Organization` | `name` | `organizations` |
| 2.3.2 | **CUIT** | `Organization` | `cuit` | `organizations` |
| 2.3.3 | **Tel√©fono** | `Organization` | `phone` | `organizations` |
| 2.3.4 | **Email** | `Organization` | `email` | `organizations` |
| 2.3.5 | **Logo** | `Organization` | `logo` | `organizations` |
| 2.3.6 | **Punto de venta AFIP** | `Organization` | `afipPuntoDeVenta` | `organizations` |

### 2.4 Identidad de Proveedores

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 2.4.1 | **Nombre / Raz√≥n social** | `Supplier` | `name`, `legalName` | `suppliers` |
| 2.4.2 | **CUIT** | `Supplier` | `cuit` | `suppliers` |
| 2.4.3 | **Contacto (nombre, email, tel√©fono)** | `Supplier` | `contactName`, `email`, `phone` | `suppliers` |
| 2.4.4 | **Direcci√≥n (JSON)** | `Supplier` | `address` | `suppliers` |
| 2.4.5 | **Informaci√≥n bancaria (JSON)** | `Supplier` | `bankInfo` | `suppliers` |
| 2.4.6 | **Condici√≥n fiscal** | `Supplier` | `taxCondition` | `suppliers` |

### 2.5 Datos de Perfiles No Reclamados (Scraping de Registros P√∫blicos)

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 2.5.1 | **Nombre completo** | `UnclaimedProfile` | `fullName` | `unclaimed_profiles` |
| 2.5.2 | **Tel√©fono(s)** | `UnclaimedProfile` | `phone`, `phones[]` | `unclaimed_profiles` |
| 2.5.3 | **Email** | `UnclaimedProfile` | `email` | `unclaimed_profiles` |
| 2.5.4 | **CUIT** | `UnclaimedProfile` | `cuit` | `unclaimed_profiles` |
| 2.5.5 | **Matr√≠cula profesional** | `UnclaimedProfile` | `matricula` | `unclaimed_profiles` |
| 2.5.6 | **Direcci√≥n completa** | `UnclaimedProfile` | `address` | `unclaimed_profiles` |
| 2.5.7 | **Provincia, ciudad, c√≥digo postal** | `UnclaimedProfile` | `province`, `city`, `postalCode` | `unclaimed_profiles` |
| 2.5.8 | **Profesi√≥n y categor√≠a** | `UnclaimedProfile` | `profession`, `specialty`, `category` | `unclaimed_profiles` |
| 2.5.9 | **WhatsApp ID** | `UnclaimedProfile` | `whatsappId` | `unclaimed_profiles` |

### 2.6 Datos de Registros de Verificaci√≥n

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 2.6.1 | **Matr√≠cula profesional** | `VerificationRegistry` | `matricula` | `verification_registry` |
| 2.6.2 | **Nombre completo** | `VerificationRegistry` | `fullName` | `verification_registry` |
| 2.6.3 | **Provincia** | `VerificationRegistry` | `province` | `verification_registry` |

### 2.7 Datos de Registros Pendientes (Pre-registro)

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 2.7.1 | **Tel√©fono** | `PendingRegistration` | `phone` | `pending_registrations` |
| 2.7.2 | **CUIT** | `PendingRegistration` | `cuit` | `pending_registrations` |
| 2.7.3 | **Nombre del negocio** | `PendingRegistration` | `businessName` | `pending_registrations` |
| 2.7.4 | **Nombre del administrador** | `PendingRegistration` | `adminName` | `pending_registrations` |
| 2.7.5 | **Email** | `PendingRegistration` | `email` | `pending_registrations` |

### 2.8 Datos de Soporte P√∫blico (Visitantes An√≥nimos)

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 2.8.1 | **Nombre del visitante** | `PublicSupportConversation` | `visitorName` | `public_support_conversations` |
| 2.8.2 | **Email del visitante** | `PublicSupportConversation` | `visitorEmail` | `public_support_conversations` |
| 2.8.3 | **Tel√©fono del visitante** | `PublicSupportConversation` | `visitorPhone` | `public_support_conversations` |

### 2.9 Datos de Solicitudes ARCO (Ley 25.326)

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 2.9.1 | **Nombre del solicitante** | `DataAccessRequest` | `requesterName` | `data_access_requests` |
| 2.9.2 | **Email del solicitante** | `DataAccessRequest` | `requesterEmail` | `data_access_requests` |
| 2.9.3 | **Tel√©fono del solicitante** | `DataAccessRequest` | `requesterPhone` | `data_access_requests` |
| 2.9.4 | **DNI del solicitante** | `DataAccessRequest` | `requesterDni` | `data_access_requests` |

### 2.10 Perfil P√∫blico de Negocio

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 2.10.1 | **Nombre de exhibici√≥n** | `BusinessPublicProfile` | `displayName` | `business_public_profiles` |
| 2.10.2 | **N√∫mero de WhatsApp** | `BusinessPublicProfile` | `whatsappNumber` | `business_public_profiles` |
| 2.10.3 | **Tel√©fono** | `BusinessPublicProfile` | `phone` | `business_public_profiles` |
| 2.10.4 | **Direcci√≥n** | `BusinessPublicProfile` | `address` | `business_public_profiles` |
| 2.10.5 | **Logo y foto de portada** | `BusinessPublicProfile` | `logo`, `coverPhoto` | `business_public_profiles` |

---

## 3. üü† DATOS DE UBICACI√ìN Y RASTREO EN TIEMPO REAL (RIESGO ALTO)

> **Nota Ley 25.326:** Los datos de geolocalizaci√≥n se consideran datos personales. La vigilancia continua de ubicaci√≥n de empleados es especialmente sensible bajo la √≥ptica de la protecci√≥n de datos laborales.

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 3.1 | **Ubicaci√≥n actual del t√©cnico** | `TechnicianLocation` | `latitude`, `longitude`, `accuracy`, `heading`, `speed`, `altitude` | `technician_locations` |
| 3.2 | **Historial de ubicaciones del t√©cnico** | `TechnicianLocationHistory` | `latitude`, `longitude`, `accuracy`, `heading`, `speed` | `technician_location_history` |
| 3.3 | **Sesi√≥n de tracking activa** | `TrackingSession` | `currentLat`, `currentLng`, `currentSpeed`, `currentHeading`, `destinationLat`, `destinationLng`, `destinationAddress` | `tracking_sessions` |
| 3.4 | **Polil√≠nea de ruta** | `TrackingSession` | `routePolyline` | `tracking_sessions` |
| 3.5 | **Historial de ubicaciones de tracking** | `TrackingLocationHistory` | `lat`, `lng`, `speed`, `heading`, `accuracy`, `movementMode` | `tracking_location_history` |
| 3.6 | **Cach√© de ETA (origen/destino)** | `EtaCache` | `originLat`, `originLng`, `destLat`, `destLng` | `eta_cache` |
| 3.7 | **Ruta optimizada del t√©cnico** | `TechnicianRoute` | `origin`, `destination`, `waypoints`, `routeUrl` | `technician_routes` |
| 3.8 | **Direcci√≥n del cliente (impl√≠cita en Job)** | `Customer` | `address` (JSON) | `customers` |
| 3.9 | **Direcci√≥n del dep√≥sito/almac√©n** | `Warehouse` | `address` (JSON) | `warehouses` |

---

## 4. üü† DATOS FINANCIEROS Y DE PAGO (RIESGO ALTO)

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 4.1 | **CAE de AFIP (n√∫mero de autorizaci√≥n)** | `Invoice` | `afipCae` | `invoices` |
| 4.2 | **C√≥digo QR de AFIP** | `Invoice` | `afipQrCode` | `invoices` |
| 4.3 | **Montos de factura** | `Invoice` | `subtotal`, `taxAmount`, `total` | `invoices` |
| 4.4 | **√çtems de factura (JSON)** | `Invoice` | `items` | `invoices` |
| 4.5 | **Montos de pago** | `Payment` | `amount` | `payments` |
| 4.6 | **Referencia de pago (puede contener CBU/CVU)** | `Payment` | `reference` | `payments` |
| 4.7 | **ID de pago MercadoPago** | `SubscriptionPayment` | `mpPaymentId` | `subscription_payments` |
| 4.8 | **ID de preferencia MercadoPago** | `SubscriptionPayment` | `mpPreferenceId` | `subscription_payments` |
| 4.9 | **ID de pagador MercadoPago** | `OrganizationSubscription` | `mpPayerId` | `organization_subscriptions` |
| 4.10 | **ID de suscripci√≥n MercadoPago** | `OrganizationSubscription` | `mpSubscriptionId` | `organization_subscriptions` |
| 4.11 | **ID de chargeback MercadoPago** | `Chargeback` | `mpChargebackId`, `mpPaymentId` | `chargebacks` |
| 4.12 | **Montos de disputa** | `PaymentDispute` | `disputedAmount`, `recoveredAmount` | `payment_disputes` |
| 4.13 | **URLs de evidencia de disputa** | `PaymentDispute` | `evidenceUrls`, `evidenceDocuments` | `payment_disputes` |
| 4.14 | **Informaci√≥n bancaria del proveedor (JSON)** | `Supplier` | `bankInfo` | `suppliers` |
| 4.15 | **L√≠mite de cr√©dito del proveedor** | `Supplier` | `creditLimit` | `suppliers` |
| 4.16 | **Montos de dep√≥sito/se√±a** | `Job` | `depositAmount`, `paymentAmount` | `jobs` |
| 4.17 | **Preferencia de checkout MP** | `Job` | `mpPreferenceId` | `jobs` |
| 4.18 | **Monto pagado por cr√©ditos** | `CreditPurchase` | `amountPaid` | `credit_purchases` |
| 4.19 | **Montos de pago de suscripci√≥n** | `SubscriptionPayment` | `amount` | `subscription_payments` |
| 4.20 | **URL de recibo** | `SubscriptionPayment` | `receiptUrl` | `subscription_payments` |
| 4.21 | **Montos de fallback payments** | `FallbackPayment` | `amount` | `fallback_payments` |
| 4.22 | **P√≥liza de seguro del veh√≠culo** | `Vehicle` | `insuranceCompany`, `insurancePolicyNumber` | `vehicles` |
| 4.23 | **Tarifas horarias UOCRA por organizaci√≥n** | `OrganizationPricingSettings` | `uocraOficialRate`, `uocraMedioOficialRate`, `uocraAyudanteRate` | `organization_pricing_settings` |
| 4.24 | **Tarifas laborales por especialidad** | `OrganizationLaborRate` | `hourlyRate` | `organization_labor_rates` |

---

## 5. üü° DATOS DE COMUNICACIONES (RIESGO MEDIO)

### 5.1 Mensajes de WhatsApp

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 5.1.1 | **Contenido de mensaje** | `WaMessage` | `content` | `wa_messages` |
| 5.1.2 | **Contenido original (multi-idioma)** | `WaMessage` | `originalContent` | `wa_messages` |
| 5.1.3 | **Contenido traducido** | `WaMessage` | `translatedContent` | `wa_messages` |
| 5.1.4 | **Tel√©fono del remitente/destinatario** | `WaMessage` | `from`, `to` | `wa_messages` |
| 5.1.5 | **Media adjunta (URLs)** | `WaMessage` | `mediaUrl`, `mediaId` | `wa_messages` |
| 5.1.6 | **Metadatos de IA (acciones, confianza)** | `WaMessage` | `aiActionMetadata`, `aiActionTaken`, `aiConfidence` | `wa_messages` |
| 5.1.7 | **Tel√©fono del cliente en conversaci√≥n** | `WaConversation` | `customerPhone` | `wa_conversations` |
| 5.1.8 | **Nombre del cliente en conversaci√≥n** | `WaConversation` | `customerName` | `wa_conversations` |
| 5.1.9 | **Vista previa del √∫ltimo mensaje** | `WaConversation` | `lastMessagePreview` | `wa_conversations` |

### 5.2 Mensajes de WhatsApp (Legacy)

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 5.2.1 | **Contenido de mensaje** | `WhatsAppMessage` | `content` | `whatsapp_messages` |
| 5.2.2 | **URL de media** | `WhatsAppMessage` | `mediaUrl` | `whatsapp_messages` |
| 5.2.3 | **Tel√©fono** | `WhatsAppMessage` | `phone` | `whatsapp_messages` |

### 5.3 Mensajes de Audio y Transcripciones

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 5.3.1 | **URL del audio** | `AudioMessage` | `mediaUrl` | `audio_messages` |
| 5.3.2 | **Tel√©fono del remitente** | `AudioMessage` | `senderPhone` | `audio_messages` |
| 5.3.3 | **Nombre del remitente** | `AudioMessage` | `senderName` | `audio_messages` |
| 5.3.4 | **Transcripci√≥n del audio** | `AudioMessage` | `transcription` | `audio_messages` |
| 5.3.5 | **Transcripci√≥n de voz** | `VoiceTranscript` | `transcription`, `humanTranscription` | `voice_transcripts` |
| 5.3.6 | **Datos extra√≠dos por IA (JSON)** | `VoiceTranscript` | `extractionData`, `humanExtraction` | `voice_transcripts` |
| 5.3.7 | **URL del audio de voz** | `VoiceTranscript` | `audioUrl` | `voice_transcripts` |
| 5.3.8 | **Transcripci√≥n de mensaje de voz** | `VoiceMessage` | `transcription` | `voice_messages` |
| 5.3.9 | **Datos extra√≠dos de voz (JSON)** | `VoiceMessage` | `extractedData` | `voice_messages` |
| 5.3.10 | **URL del audio** | `VoiceMessage` | `audioUrl` | `voice_messages` |
| 5.3.11 | **Tel√©fono del remitente** | `VoiceMessage` | `phone` | `voice_messages` |

### 5.4 Respuestas Autom√°ticas y Contexto de Conversaci√≥n

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 5.4.1 | **Tel√©fono del destinatario** | `AutoResponseLog` | `recipientPhone` | `auto_response_logs` |
| 5.4.2 | **Mensaje de respuesta** | `AutoResponseLog` | `message` | `auto_response_logs` |
| 5.4.3 | **Tel√©fono del cliente en contexto** | `ConversationContext` | `customerPhone` | `conversation_contexts` |
| 5.4.4 | **Nombre del cliente en contexto** | `ConversationContext` | `customerName` | `conversation_contexts` |
| 5.4.5 | **Historial de mensajes (JSON)** | `ConversationContext` | `messageHistory` | `conversation_contexts` |
| 5.4.6 | **Contenido combinado de mensajes** | `MessageAggregationEvent` | `combinedContent` | `message_aggregation_events` |
| 5.4.7 | **Tel√©fono del cliente en agregaci√≥n** | `MessageAggregationEvent` | `customerPhone` | `message_aggregation_events` |

### 5.5 SMS Salientes

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 5.5.1 | **Tel√©fono del destinatario** | `SmsOutboundQueue` | `phone` | `sms_outbound_queue` |
| 5.5.2 | **Cuerpo del SMS** | `SmsOutboundQueue` | `body` | `sms_outbound_queue` |

### 5.6 Cola de Mensajes WhatsApp Salientes

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 5.6.1 | **N√∫mero de destino** | `WaOutboundQueue` | `to` | `wa_outbound_queue` |
| 5.6.2 | **Payload del mensaje (JSON)** | `WaOutboundQueue` | `payload` | `wa_outbound_queue` |

### 5.7 Soporte P√∫blico (Chat)

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 5.7.1 | **Contenido del mensaje** | `PublicSupportMessage` | `content` | `public_support_messages` |
| 5.7.2 | **Suscripci√≥n push** | `PublicSupportConversation` | `pushSubscription` | `public_support_conversations` |

---

## 6. üü° DATOS DE INTELIGENCIA ARTIFICIAL Y LOGS (RIESGO MEDIO)

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 6.1 | **Mensaje del cliente procesado por IA** | `AIConversationLog` | `customerMessage` | `ai_conversation_logs` |
| 6.2 | **Transcripci√≥n procesada por IA** | `AIConversationLog` | `transcription` | `ai_conversation_logs` |
| 6.3 | **Respuesta generada por IA** | `AIConversationLog` | `aiResponse` | `ai_conversation_logs` |
| 6.4 | **Entidades extra√≠das (JSON)** | `AIConversationLog` | `extractedEntities` | `ai_conversation_logs` |
| 6.5 | **Intenci√≥n detectada** | `AIConversationLog` | `detectedIntent` | `ai_conversation_logs` |
| 6.6 | **Respuesta corregida por humano** | `AIConversationLog` | `correctedResponse`, `modifiedContent` | `ai_conversation_logs` |
| 6.7 | **Notas de feedback** | `AIConversationLog` | `feedbackNotes` | `ai_conversation_logs` |
| 6.8 | **Instrucciones personalizadas de IA** | `AIConfiguration` | `customInstructions` | `ai_configurations` |
| 6.9 | **Informaci√≥n de precios en configuraci√≥n IA** | `AIConfiguration` | `pricingInfo` | `ai_configurations` |
| 6.10 | **√çtems de FAQ (JSON)** | `AIConfiguration` | `faqItems` | `ai_configurations` |

---

## 7. üü° FOTOGRAF√çAS Y DOCUMENTOS (RIESGO MEDIO)

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 7.1 | **Fotos de trabajo (antes/durante/despu√©s)** | `JobPhoto` | `photoUrl`, `thumbnailUrl` | `job_photos` |
| 7.2 | **Fotos de trabajo inline** | `Job` | `photos[]` | `jobs` |
| 7.3 | **Firma digital del cliente** | `Job` | `customerSignature` | `jobs` |
| 7.4 | **Documentos de veh√≠culo** | `VehicleDocument` | `fileUrl`, `fileName` | `vehicle_documents` |
| 7.5 | **Documentos de verificaci√≥n** | `VerificationSubmission` | `documentUrl`, `documentFilename` | `verification_submissions` |
| 7.6 | **Valor de verificaci√≥n enviado** | `VerificationSubmission` | `submittedValue` | `verification_submissions` |
| 7.7 | **URL de exportaci√≥n generada** | `ExportRequest` | `fileUrl`, `fileName` | `export_requests` |
| 7.8 | **URL de descarga de solicitud ARCO** | `DataAccessRequest` | `downloadUrl` | `data_access_requests` |
| 7.9 | **URLs de reportes generados** | `ReportHistory` | `fileUrl`, `downloadUrl` | `report_history` |
| 7.10 | **URL de reporte ejecutado** | `ReportExecution` | `fileUrl` | `report_executions` |
| 7.11 | **Im√°genes de productos** | `Product` | `imageUrl`, `images[]` | `products` |

---

## 8. üü° DATOS DE AUDITOR√çA Y SESIONES (RIESGO MEDIO)

> **Nota:** Los logs de auditor√≠a contienen metadatos que, en combinaci√≥n, permiten identificar usuarios e inferir comportamientos.

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 8.1 | **Direcci√≥n IP** | `AuditLog` | `ipAddress` | `audit_logs` |
| 8.2 | **User Agent** | `AuditLog` | `userAgent` | `audit_logs` |
| 8.3 | **Metadata de acci√≥n (JSON)** | `AuditLog` | `metadata` | `audit_logs` |
| 8.4 | **IP en intentos de login** | `LoginAttempt` | `ipAddress` | `login_attempts` |
| 8.5 | **User Agent en login** | `LoginAttempt` | `userAgent` | `login_attempts` |
| 8.6 | **Identificador de login** | `LoginAttempt` | `identifier` | `login_attempts` |
| 8.7 | **IP en tokens de refresco** | `RefreshToken` | `ipAddress` | `refresh_tokens` |
| 8.8 | **User Agent en tokens de refresco** | `RefreshToken` | `userAgent` | `refresh_tokens` |
| 8.9 | **IP en consentimiento** | `UserConsentLog` | `ipAddress` | `user_consent_log` |
| 8.10 | **IP en reconocimientos de compliance** | `ComplianceAcknowledgment` | `ipAddress` | `compliance_acknowledgments` |
| 8.11 | **Info de dispositivo** | `ComplianceAcknowledgment` | `deviceInfo` (JSON) | `compliance_acknowledgments` |
| 8.12 | **IP en eventos de suscripci√≥n** | `SubscriptionEvent` | `ipAddress` | `subscription_events` |
| 8.13 | **IP en auditor√≠a de solicitud ARCO** | `DataRequestAuditLog` | `ipAddress` | `data_request_audit_logs` |
| 8.14 | **IP en operaciones de sync** | `SyncOperation` | `ipAddress` | `sync_operations` |
| 8.15 | **Device ID en sync** | `SyncOperation` | `deviceId` | `sync_operations` |
| 8.16 | **Datos de webhook (JSON con PII potencial)** | `WaWebhookLog` | `payload` | `wa_webhook_logs` |
| 8.17 | **IP/fingerprint de clics en marketplace** | `MarketplaceClick` | `consumerIp`, `consumerFingerprint`, `consumerUserAgent` | `marketplace_clicks` |
| 8.18 | **User Agent en soporte p√∫blico** | `PublicSupportConversation` | `userAgent` | `public_support_conversations` |
| 8.19 | **Datos de trabajo fallido (pueden contener PII)** | `FailedJob` | `jobData` (JSON) | `failed_jobs` |

---

## 9. üü° DATOS DE OUTREACH Y CAMPA√ëAS (RIESGO MEDIO)

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 9.1 | **Email configurado para campa√±as** | `OutreachCampaign` | `emailReplyTo`, `emailFromName` | `outreach_campaigns` |
| 9.2 | **Contenido de plantilla de outreach** | `OutreachCampaign` | `templateContent` | `outreach_campaigns` |
| 9.3 | **Destinatarios de reportes programados (JSON)** | `ScheduledReport` | `recipients` | `scheduled_reports` |
| 9.4 | **Email de entrega de exportaci√≥n** | `ExportRequest` | `deliveryEmail` | `export_requests` |

---

## 10. üü¢ DATOS DE VEH√çCULOS E INFRAESTRUCTURA (RIESGO BAJO-MEDIO)

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 10.1 | **Patente del veh√≠culo** | `Vehicle` | `plateNumber` | `vehicles` |
| 10.2 | **VIN del veh√≠culo** | `Vehicle` | `vin` | `vehicles` |
| 10.3 | **Datos del seguro** | `Vehicle` | `insuranceCompany`, `insurancePolicyNumber` | `vehicles` |
| 10.4 | **Datos de contacto de almac√©n** | `Warehouse` | `contactName`, `contactPhone`, `contactEmail` | `warehouses` |
| 10.5 | **N√∫mero de factura de mantenimiento** | `VehicleMaintenance` | `invoiceNumber` | `vehicle_maintenance` |
| 10.6 | **N√∫mero de WhatsApp del inventario BSP** | `WhatsAppNumberInventory` | `phoneNumber` | `whatsapp_number_inventory` |
| 10.7 | **N√∫mero BSP en cr√©ditos** | `WhatsAppCredits` | `bspPhoneNumber` | `whatsapp_credits` |
| 10.8 | **N√∫mero de WhatsApp Business** | `WhatsAppBusinessAccount` | `displayPhoneNumber` | `whatsapp_business_accounts` |

---

## 11. SNAPSHOTS INMUTABLES (Datos Duplicados en Contexto de Auditor√≠a)

> **Importante:** Estos son datos "congelados" al momento del servicio para fines de auditor√≠a. Contienen PII duplicada que tambi√©n debe ser notificada.

| # | Dato | Modelo Prisma | Campo(s) | Tabla DB |
|---|------|---------------|----------|----------|
| 11.1 | **Patente del veh√≠culo al momento del trabajo** | `Job` | `vehiclePlateAtJob` | `jobs` |
| 11.2 | **Nombre del conductor al momento del trabajo** | `Job` | `driverNameAtJob` | `jobs` |
| 11.3 | **Licencia del conductor al momento del trabajo** | `Job` | `driverLicenseAtJob` | `jobs` |
| 11.4 | **Snapshot de patente por visita** | `JobVisitVehicle` | `vehiclePlateSnapshot` | `job_visit_vehicles` |
| 11.5 | **Snapshot de nombre del conductor por visita** | `JobVisitVehicleDriver` | `driverNameSnapshot` | `job_visit_vehicle_drivers` |
| 11.6 | **Snapshot de licencia del conductor por visita** | `JobVisitVehicleDriver` | `driverLicenseSnapshot` | `job_visit_vehicle_drivers` |

---

## RESUMEN ESTAD√çSTICO

| Categor√≠a | Cantidad de Campos Sensibles | Nivel de Riesgo |
|-----------|------------------------------|-----------------|
| 1. Credenciales y Secretos | 19 | üî¥ CR√çTICO |
| 2. Datos Personales (PII) | 58 | üü† ALTO |
| 3. Geolocalizaci√≥n y Rastreo | 9 | üü† ALTO |
| 4. Datos Financieros y de Pago | 24 | üü† ALTO |
| 5. Comunicaciones | 27 | üü° MEDIO |
| 6. Inteligencia Artificial y Logs | 10 | üü° MEDIO |
| 7. Fotograf√≠as y Documentos | 11 | üü° MEDIO |
| 8. Auditor√≠a y Sesiones | 19 | üü° MEDIO |
| 9. Outreach y Campa√±as | 4 | üü° MEDIO |
| 10. Veh√≠culos e Infraestructura | 8 | üü¢ BAJO-MEDIO |
| 11. Snapshots Inmutables | 6 | üü† ALTO |
| **TOTAL** | **195** | ‚Äî |

---

## MODELOS PRISMA CON DATOS SENSIBLES (Referencia R√°pida)

```
CR√çTICO:        Organization, WhatsAppBusinessAccount, User, RefreshToken,
                OtpCode, TrackingToken, ExportRequest, DataAccessRequest,
                UnclaimedProfile, Review, EmployeeVerificationToken, Job

ALTO:           Customer, Supplier, PendingRegistration, TechnicianLocation,
                TechnicianLocationHistory, TrackingSession, TrackingLocationHistory,
                EtaCache, TechnicianRoute, Invoice, Payment, SubscriptionPayment,
                OrganizationSubscription, Chargeback, PaymentDispute,
                OrganizationPricingSettings, OrganizationLaborRate,
                BusinessPublicProfile, VerificationRegistry,
                VerificationSubmission, DataAccessRequest,
                PublicSupportConversation, JobVisitVehicle,
                JobVisitVehicleDriver

MEDIO:          WaMessage, WaConversation, WhatsAppMessage, VoiceTranscript,
                VoiceMessage, AudioMessage, AutoResponseLog,
                ConversationContext, MessageAggregationEvent,
                SmsOutboundQueue, WaOutboundQueue, AIConversationLog,
                AIConfiguration, JobPhoto, VehicleDocument, AuditLog,
                LoginAttempt, UserConsentLog, ComplianceAcknowledgment,
                SubscriptionEvent, WaWebhookLog, MarketplaceClick,
                FailedJob, OutreachCampaign, ScheduledReport,
                SyncOperation, PublicSupportMessage, ReportHistory,
                ReportExecution

BAJO-MEDIO:     Vehicle, Warehouse, VehicleMaintenance,
                WhatsAppNumberInventory, WhatsAppCredits
```

---

> **Documento generado:** 2026-02-12
> **Fuente:** `apps/web/prisma/schema.prisma` (5,173 l√≠neas)
> **Referencia legal:** Secci√≥n 1.2 de `LEGISLATIVE_STRESS_TEST.md`
> **Estado:** ‚úÖ Inventario completo ‚Äî pendiente de instrucciones adicionales del usuario
